(this["webpackJsonpvirtual-keypad"]=this["webpackJsonpvirtual-keypad"]||[]).push([[0],{273:function(e){e.exports=JSON.parse('{"translation":{"Virtual Keypad":"Virtual Keypad","Clover":"Clover","Clover Domain":"Clover Domain","Merchant ID":"Merchant ID","Access Token":"Access Token","Friendly ID":"Friendly ID","Allow Manual Card Entry":"Allow Manual Card Entry","Auto-connect":"Auto-connect","Submit":"Submit","Reset":"Reset","Cancel":"Cancel","Select Devices":"Select Devices","Cloud Pay Display is installed":"Cloud Pay Display is installed","Cloud Pay Display is NOT installed":"Cloud Pay Display is NOT installed","Show details":"Show details\u2026","Menu":"Menu","MODE":{"TRANSACTION":"Keypad","HISTORY":"History"},"Show Welcome":"Show Welcome","Reset Device":"Reset Device","Disconnect":"Disconnect","Date":"Date","Type":"Type","Amount":"Amount","ACTION":{"ACCEPT_PAYMENT":"Accept","ACCEPT_SIGNATURE":"Accept","DISCONNECT":"Disconnect","IDENTIFY":"Identify","INVOKE_INPUT_OPTION":"Invoke","REJECT_PAYMENT":"Reject","REJECT_SIGNATURE":"Reject","RESET":"Reset","SHOW_WELCOME":"Show Welcome","TRANSACTION":"Transaction","VOID_PAYMENT":"Void","CANCEL":"Cancel","OK":"OK","Type Card":"Type Card","Enter":"Enter","Clear":"Clear","Done":"Done","No receipt":"No receipt","Print":"Print","Yes":"Yes","No":"No"},"Shortcut keys":"Shortcut keys","KEY_CODE":{"Backspace":"Backspace","Delete":"Delete","Digit0":"Digit 0","Digit1":"Digit 1","Digit2":"Digit 2","Digit3":"Digit 3","Digit4":"Digit 4","Digit5":"Digit 5","Digit6":"Digit 6","Digit7":"Digit 7","Digit8":"Digit 8","Digit9":"Digit 9","Enter":"Enter","Escape":"Esc","F1":"F1","F2":"F2","Numpad0":"Numpad 0","Numpad1":"Numpad 1","Numpad2":"Numpad 2","Numpad3":"Numpad 3","Numpad4":"Numpad 4","Numpad5":"Numpad 5","Numpad6":"Numpad 6","Numpad7":"Numpad 7","Numpad8":"Numpad 8","Numpad9":"Numpad 9","NumpadAdd":"Numpad Add","NumpadDecimal":"Numpad Decimal","NumpadDivide":"Numpad Divide","NumpadEnter":"Numpad Enter","NumpadMultiply":"Numpad Multiply","NumpadSubtract":"Numpad Subtract","Period":"Period"},"KEY":{"0":"0","1":"1","2":"2","3":"3","4":"4","5":"5","6":"6","7":"7","8":"8","9":"9","00":"00","X":"X","<":"<","O":"O"},"TRANSACTION":{"SALE":"Sale","CREDIT":"Credit","VOID":"Void"},"Details":"Details","Partial Payment":"Partial Payment","Remaining":"Remaining","Payment ID":"Payment ID","External ID":"External ID","External Ref":"External Ref","Order ID":"Order ID","Total":"Total","Tip":"Tip","Card":"Card","CARD":{"VISA":"Visa","MC":"Mastercard","AMEX":"AmEx","DISCOVER":"Discover","DINERS_CLUB":"Diner\'s Club","JCB":"JCB","MAESTRO":"Maestro","SOLO":"Solo","LASER":"Laser","CHINA_UNION_PAY":"China Union Pay","CARTE_BLANCHE":"Carte Blanche","UNKNOWN":"Unknown","GIFT_CARD":"Gift Card","EBT":"EBT","GIROCARD":"Girocard","INTERAC":"Interac","OTHER":"Other"},"CARDHOLDER_NAME":{"MANUALLY ENTERED":"(manually entered)"},"Process":"Process","Void":"Void","ERROR":{"Amount is required":"Amount is required","Amount is invalid":"Amount is invalid","Merchant has no devices":"Merchant has no devices","Merchant has no devices with Cloud Pay Display installed":"Merchant has no devices with Cloud Pay Display installed","Device not found":"Device not found","Device does not have Cloud Pay Display installed":"Device does not have Cloud Pay Display installed","No payment was specified":"No payment was specified","Invalid transaction type":"Invalid transaction type"},"STATUS":{"Accepting payment\u2026":"Accepting payment\u2026","Accepting signature\u2026":"Accepting signature\u2026","Rejecting payment\u2026":"Rejecting payment\u2026","Rejecting signature\u2026":"Rejecting signature\u2026","Identifying\u2026":"Identifying\u2026","Connecting\u2026":"Connecting\u2026","Resetting\u2026":"Resetting\u2026","Processing...":"Processing\u2026","Processing\u2026":"Processing\u2026","Verify Signature":"Verify Signature","Customer is tipping\u2026":"Customer is tipping\u2026","Customer is choosing payment method\u2026":"Customer is choosing payment method\u2026","Ready":"Ready","Timed out":"Timed out","Card Number":"Card Number","Customer is signing\u2026":"Customer is signing\u2026","Customer is selecting receipt type\u2026":"Customer is selecting receipt type\u2026","CVV Security Code":"CVV Security Code","Expiration Date":"Expiration Date","Transaction failed: Error connecting to payment gateway. Please try again later":"Transaction failed: Error connecting to payment gateway. Please try again later","This may be a duplicate, do you want to accept this payment?":"This may be a duplicate, do you want to accept this payment?","Partial authorization":"Partial authorization for {{amount}}<br/>Continue with transaction?","Processing card ending":"Processing Card ending in {{last4}}\u2026"},"connected":"connected"}}')},283:function(e,t,n){e.exports=n(610)},608:function(e,t,n){},609:function(e,t,n){},610:function(e,t,n){"use strict";n.r(t);var a,r=n(0),c=n.n(r),o=n(28),i=n.n(o),s=n(5),u=n(35),l=n(12),d="ACCEPT_PAYMENT",m="ACCEPT_SIGNATURE",p="DISCONNECT",v="IDENTIFY",f="INVOKE_INPUT_OPTION",b="REJECT_PAYMENT",y="REJECT_SIGNATURE",E="RESET",O="SHOW_WELCOME",h="TRANSACTION",j="TRANSACTION_MODE",g="CLOUD_PAY_DISPLAY",C=Object(l.a)({},g,"Cloud Pay Display"),N=Object.fromEntries(Object.entries(C).map((function(e){return e.reverse()}))),k=/^(Flex|Mini|Mobile)/i,D="SALE",w="CREDIT",T="VOID",A=n(36),I=n(270),x=n(84),R=[],S=n(1),P={cloverDomain:"",merchantId:"",accessToken:"",friendlyId:"",manualCardEntry:!1,autoConnect:!1,loading:void 0},M=n(13),L=n.n(M),_={connector:null,connected:!1},V=function(e){var t=e.device.doTxStart;e.device.doTxStart=function(n,a,r){return"CREDIT"===r&&(n.externalReferenceId=n.externalPaymentId),t.call(e.device,n,a,r)}},Y=function(e){try{null===e||void 0===e||e.dispose()}catch(t){}},K={list:[],selected:""},B={message:null,stack:null},F={width:0,height:0,strokes:[]},U=n(4),q=n.n(U),W=n(7),H=n(48),J=function e(t,n){var a=n.retries,r=void 0===a?3:a,c=Object(H.a)(n,["retries"]);return fetch(t,c).catch((function(n){if(r>1)return e(t,Object(S.a)({retries:r-1},c));throw n}))},G=function(e){var t=e.cloverDomain,n=e.merchantId,a=e.deviceId,r=e.accessToken;return J(new URL("/v2/merchant/".concat(n,"/device/").concat(a,"/current_apps?access_token=").concat(r),t).toString(),{method:"GET",headers:{accept:"application/json","content-type":"application/json"}}).then((function(e){return e.json()}))},X=function(e){var t=e.cloverDomain,n=e.merchantId,a=e.accessToken;return J(new URL("/v3/merchants/".concat(n,"/devices?access_token=").concat(a),t).toString(),{method:"GET",headers:{accept:"application/json","content-type":"application/json"}}).then((function(e){return e.json()}))},z=function(e,t){var n=N[t.appName];return n?Object(S.a)(Object(S.a)({},e),{},Object(l.a)({},n,!0)):e},Z=function(e,t){return e.reduce((function(e,n){var a=e[e.length-1];return a.length===t?e.push([n]):a.push(n),e}),[[]])},$=function(){var e=Object(W.a)(q.a.mark((function e(t){var n,a,r,c,o,i,s,u,l;return q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.cloverDomain,a=t.merchantId,r=t.accessToken,e.next=3,X({cloverDomain:n,merchantId:a,accessToken:r});case 3:c=e.sent,o=c.elements,i=o.filter((function(e){return k.test(e.productName)})),s=Z(i,4),u=0;case 8:if(!(u<s.length)){e.next=15;break}return e.next=11,Promise.all(s[u].map((function(e){var t=e.id;return G({cloverDomain:n,merchantId:a,accessToken:r,deviceId:t})})));case 11:s[u]=e.sent;case 12:u++,e.next=8;break;case 15:return l=s.flat(),e.abrupt("return",i.map((function(e,t){return Object(S.a)(Object(S.a)({},e),{},{apps:l[t].applications.reduce(z,{})})})));case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Q=function(e){var t=+e;return!isNaN(t)&&t>=0?(t/100).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):""},ee={active:null,mode:D,data:{}},te=Object(A.c)({actions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case"clearActions":return R;case"appendActions":var r=e.some((function(e){var t,n;return e.type===a.type&&(null===(t=e.payload)||void 0===t?void 0:t.description)===(null===(n=a.payload)||void 0===n?void 0:n.description)}));return r?e:[].concat(Object(x.a)(e),[a]);case"setActions":return a||[];case"setConnector":return[{type:p,payload:{description:"Cancel"}}];case"@@connector/onDeviceReady":case"@@connector/onResetDeviceResponse":return[{type:v},{type:h}];case"@@connector/onDeviceActivityStart":return a.inputOptions.map((function(e){return{type:f,payload:e}}));case"@@connector/onSaleResponse":case"@@connector/onVoidPaymentResponse":case"@@connector/onManualRefundResponse":return[{type:v},{type:h}];case"@@connector/onConfirmPaymentRequest":return[{type:d,payload:a},{type:b,payload:a}];case"@@connector/onVerifySignatureRequest":return[{type:m,payload:a},{type:y,payload:a}];default:return e}},buffer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case"clearBuffer":return"";case"appendBuffer":return(e+a).replace(/^0+/,"").slice(0,7);case"setBuffer":return a;case"undoBuffer":return e.length?e.slice(0,e.length-1):"";default:return e}},configuration:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case"setConfigurationLoading":return Object(S.a)(Object(S.a)({},e),{},{loading:!0});case"setConfigurationNotLoading":return Object(S.a)(Object(S.a)({},e),{},{loading:void 0});case"setConfiguration":return Object(S.a)(Object(S.a)({},e),{},{cloverDomain:a.cloverDomain||"",merchantId:a.merchantId||"",accessToken:a.accessToken||"",friendlyId:a.friendlyId||"",manualCardEntry:a.manualCardEntry||!1,autoConnect:a.autoConnect||!1});default:return e}},connection:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case"clearConnector":return Y(e.connector),_;case"setConnector":return Y(e.connector),Object(S.a)(Object(S.a)({},e),{},{connector:a,connected:!1});case"@@connector/onDeviceDisconnected":return Object(S.a)(Object(S.a)({},e),{},{connected:!1});case"@@connector/onDeviceReady":V(e.connector);var r=new L.a.remotepay.RetrieveDeviceStatusRequest;return r.setSendLastMessage(!0),e.connector.retrieveDeviceStatus(r),Object(S.a)(Object(S.a)({},e),{},{connected:!0});default:return e}},devices:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case"clearDevices":return Object(S.a)(Object(S.a)({},e),{},{list:[]});case"clearDeviceId":return Object(S.a)(Object(S.a)({},e),{},{selected:""});case"setDeviceId":return Object(S.a)(Object(S.a)({},e),{},{selected:a||""});case"setDevices":return Object(S.a)(Object(S.a)({},e),{},{list:a||[]});default:return e}},error:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case"clearError":return B;case"setError":return Object(S.a)(Object(S.a)({},e),{},{message:a.message,stack:a.stack});case"@@connector/onDeviceError":return Object(S.a)(Object(S.a)({},e),{},{message:"Device Error ".concat(a.message),stack:null});default:return e}},signature:function(){var e,t,n,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F,r=arguments.length>1?arguments[1]:void 0,c=r.type,o=r.payload;switch(c){case"clearSignature":return F;case"setSignature":return{width:(null===o||void 0===o?void 0:o.width)||0,height:(null===o||void 0===o?void 0:o.height)||0,strokes:(null===o||void 0===o?void 0:o.strokes)||[]};case"@@connector/onVerifySignatureRequest":return{width:(null===(e=o.signature)||void 0===e?void 0:e.width)||0,height:(null===(t=o.signature)||void 0===t?void 0:t.height)||0,strokes:(null===(n=o.signature)||void 0===n?void 0:n.strokes)||[]};default:return a}},status:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case"clearStatus":return"";case"setStatus":return a||"";case"@@connector/onDeviceReady":case"@@connector/onResetDeviceResponse":return"Ready";case"@@connector/onDeviceActivityStart":return a.message;case"@@connector/onSaleResponse":case"@@connector/onVoidPaymentResponse":case"@@connector/onManualRefundResponse":return"Ready";case"@@connector/onConfirmPaymentRequest":return a.challenges[0].message;case"@@connector/onVerifySignatureRequest":return"Verify Signature";default:return e}},transactions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case"setTransactionMode":return Object(S.a)(Object(S.a)({},e),{},{mode:a});case"setActiveTransaction":if(a.id){var r=e.data[a.id]||{};return Object(S.a)(Object(S.a)({},e),{},{active:a.id,data:Object(S.a)(Object(S.a)({},e.data),{},Object(l.a)({},a.id,Object(S.a)(Object(S.a)({},e.data[a.id]),{},{id:a.id,timestamp:Date.now(),type:a.type||r.type,amount:a.amount||r.amount||0,tipAmount:a.tipAmount||r.tipAmount||0})))})}return Object(S.a)(Object(S.a)({},e),{},{active:""});case"hideTransaction":return Object(S.a)(Object(S.a)({},e),{},{data:Object(S.a)(Object(S.a)({},e.data),{},Object(l.a)({},a,Object(S.a)(Object(S.a)({},e.data[a]),{},{visible:!1})))});case"showTransaction":return Object(S.a)(Object(S.a)({},e),{},{data:Object(S.a)(Object(S.a)({},e.data),{},Object(l.a)({},a,Object(S.a)(Object(S.a)({},e.data[a]),{},{visible:!0})))});case"removeTransaction":var c=Object(S.a)(Object(S.a)({},e),{},{data:Object(S.a)({},e.data)});return delete c.data[a],c;case"updateTransaction":var o=e.data[a.id]||{};return Object(S.a)(Object(S.a)({},e),{},{data:Object(S.a)(Object(S.a)({},e.data),{},Object(l.a)({},a.id,Object(S.a)(Object(S.a)({},o),{},{id:a.id,timestamp:Date.now(),visible:a.visible||o.visible||!1,amount:a.amount||o.amount||0,tipAmount:a.tipAmount||o.tipAmount||0,type:a.type||o.type||"",payment:a.payment||o.payment||null})))});case"@@connector/onSaleResponse":return a.success?Object(S.a)(Object(S.a)({},e),{},{active:"",data:Object(S.a)(Object(S.a)({},e.data),{},Object(l.a)({},a.payment.externalPaymentId,Object(S.a)(Object(S.a)({},e.data[a.payment.externalPaymentId]),{},{id:a.payment.externalPaymentId,timestamp:Date.now(),visible:!0,type:D,payment:a.payment})))}):e;case"@@connector/onManualRefundResponse":return a.success?Object(S.a)(Object(S.a)({},e),{},{active:"",data:Object(S.a)(Object(S.a)({},e.data),{},Object(l.a)({},a.credit.externalReferenceId,Object(S.a)(Object(S.a)({},e.data[a.credit.externalReferenceId]),{},{id:a.credit.externalReferenceId,timestamp:Date.now(),visible:!0,type:w,payment:a.credit})))}):e;case"@@connector/onVoidPaymentResponse":return a.success?Object(S.a)(Object(S.a)({},e),{},{active:"",data:Object(S.a)(Object(S.a)({},e.data),{},Object(l.a)({},a.payment.externalPaymentId,Object(S.a)(Object(S.a)({},e.data[a.payment.externalPaymentId]),{},{id:a.payment.externalPaymentId,timestamp:Date.now(),visible:!0,type:T,payment:a.payment})))}):e;default:return e}}}),ne=n(8),ae=function(e){return e.configuration},re=Object(ne.a)(ae,(function(e){return e.friendlyId||"Virtual Keypad"})),ce=Object(ne.a)(ae,(function(e){return e.manualCardEntry||!1})),oe=Object(ne.a)(ce,(function(e){return e?L.a.CardEntryMethods.DEFAULT|L.a.CardEntryMethods.CARD_ENTRY_METHOD_MANUAL:L.a.CardEntryMethods.DEFAULT})),ie=Object(ne.a)(ae,(function(e){return e.autoConnect||!1})),se=Object(ne.a)(ae,(function(e){return e.loading||!1})),ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.message,n=e.stack;return{type:"setError",payload:{message:t,stack:n}}},le=function(e){return{type:"setActions",payload:e}},de=function(e){return e.connection},me=Object(ne.a)(de,(function(e){return e.connector})),pe=(Object(ne.a)(de,(function(e){return e.connected})),function(e){return{type:"setStatus",payload:e}}),ve=function(e){var t=e.configuration,n=e.devices;return localStorage.setItem("clover/virtual-keypad",JSON.stringify({configuration:Object(S.a)(Object(S.a)({},t),{},{loading:void 0}),devices:Object(S.a)(Object(S.a)({},K),{},{selected:n.selected})}))},fe=function(e){return{type:"setConfiguration",payload:{cloverDomain:e.cloverDomain,merchantId:e.merchantId,accessToken:e.accessToken,friendlyId:e.friendlyId,manualCardEntry:e.manualCardEntry,autoConnect:e.autoConnect}}},be=function(e){return{type:"setDeviceId",payload:e}},ye=function(e){return{type:"setDevices",payload:e}},Ee=function(e){var t=e.cloverDomain,n=e.merchantId,a=e.accessToken,r=e.friendlyId,c=e.manualCardEntry,o=e.autoConnect;return function(){var e=Object(W.a)(q.a.mark((function e(i,s){var u;return q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i({type:"configure",payload:{cloverDomain:t,merchantId:n,accessToken:a,friendlyId:r,manualCardEntry:c,autoConnect:o}}),e.next=4,i({type:"setConfigurationLoading"});case 4:return e.next=6,i(fe({cloverDomain:t,merchantId:n,accessToken:a,friendlyId:r,manualCardEntry:c,autoConnect:o}));case 6:return ve(s()),e.next=9,$({cloverDomain:t,merchantId:n,accessToken:a});case 9:return u=e.sent,e.next=12,i(ye(u));case 12:if(u.length){e.next=14;break}throw new Error("Merchant has no devices");case 14:if(u.some((function(e){return e.apps[g]}))){e.next=16;break}throw new Error("Merchant has no devices with Cloud Pay Display installed");case 16:e.next=22;break;case 18:return e.prev=18,e.t0=e.catch(0),e.next=22,i(ue(e.t0));case 22:return e.prev=22,e.next=25,i({type:"setConfigurationNotLoading"});case 25:return e.finish(22);case 26:case"end":return e.stop()}}),e,null,[[0,18,22,26]])})));return function(t,n){return e.apply(this,arguments)}}()},Oe=n(271),he=n(81),je=n(281),ge=n(280),Ce=function(e){return e.devices},Ne=Object(ne.a)(Ce,(function(e){return e.selected})),ke=Object(ne.a)(Ce,Ne,(function(e,t){var n=e.list;return Object(x.a)(n).sort((function(e,n){return e.id===t?-1:n.id===t?1:0}))})),De=function(e){return{type:"setConnector",payload:e}},we=function(e){return function(){var t=Object(W.a)(q.a.mark((function t(n,a){var r,c,o,i,s,u,d,m,p,v,f;return q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n({type:"connect",payload:e});case 3:return t.next=5,n(be(e));case 5:if(r=a(),ve(r),c=ae(r),o=c.cloverDomain,i=c.merchantId,s=c.accessToken,u=c.friendlyId,d=ke(r).find((function(t){return t.id===e}))){t.next=11;break}throw new Error("Device not found");case 11:if(d.apps[g]){t.next=13;break}throw new Error("Device does not have Cloud Pay Display installed");case 13:m=L.a.CloverConnectorFactoryBuilder.createICloverConnectorFactory(Object(l.a)({},L.a.CloverConnectorFactoryBuilder.FACTORY_VERSION,L.a.CloverConnectorFactoryBuilder.VERSION_12)),p=m.createICloverConnector(new L.a.WebSocketCloudCloverDeviceConfigurationBuilder("virtual-keypad",e,i,s).setCloverServer(o).setFriendlyId(u).build()),v=function(e){Object(je.a)(a,e);var t=Object(ge.a)(a);function a(){var e;return Object(Oe.a)(this,a),e=t.call(this),Object.keys(Object.getPrototypeOf(Object.getPrototypeOf(Object(he.a)(e)))).forEach((function(t){e[t]=function(e){return n({type:"@@connector/".concat(t),payload:e})}})),e}return a}(L.a.remotepay.ICloverConnectorListener),f=new v,p.addCloverConnectorListener(f),n(De(p)),n(pe("Connecting\u2026")),p.initializeConnection(),t.next=26;break;case 23:t.prev=23,t.t0=t.catch(0),n(ue(t.t0));case 26:case"end":return t.stop()}}),t,null,[[0,23]])})));return function(e,n){return t.apply(this,arguments)}}()},Te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,n=e.type,a=e.amount,r=e.tipAmount;return{type:"setActiveTransaction",payload:{id:t,type:n,amount:a,tipAmount:r}}},Ae=function(e){return{type:"hideTransaction",payload:e}},Ie=function(e){return{type:"updateTransaction",payload:{id:e.id,type:e.type,amount:e.amount,tipAmount:e.tipAmount,payment:e.payment}}},xe=function(){return function(){var e=Object(W.a)(q.a.mark((function e(t,n){var a;return q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t({type:"disconnect"});case 3:return a=me(n()),e.prev=4,a.showWelcomeScreen(),e.next=8,new Promise((function(e){return setTimeout(e,500)}));case 8:e.next=12;break;case 10:e.prev=10,e.t0=e.catch(4);case 12:return a.dispose(),e.next=15,t({type:"clearConnector"});case 15:return e.next=17,t({type:"clearDevices"});case 17:return e.next=19,t(Te());case 19:e.next=25;break;case 21:return e.prev=21,e.t1=e.catch(0),e.next=25,t(ue(e.t1));case 25:case"end":return e.stop()}}),e,null,[[0,21],[4,10]])})));return function(t,n){return e.apply(this,arguments)}}()},Re=n(279),Se=n(30),Pe=n(272),Me={en:n(273)},Le=Re.a.use(Pe.a).use(Se.e).init({fallbackLng:"en",debug:!1,keySeparator:"~",nsSeparator:!1,interpolation:{escapeValue:!1},resources:Me}),_e=function(e){return function(){var t=Object(W.a)(q.a.mark((function t(n,a){return q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{n(Object(S.a)(Object(S.a)({},e),{},{type:"reset"})),n(pe("Resetting\u2026")),n({type:"clearActions"}),me(a()).resetDevice()}catch(r){n(ue(r))}case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},Ve=function(e){return e.error},Ye=function(e){return function(){var t=Object(W.a)(q.a.mark((function t(n,a){return q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{n(Object(S.a)(Object(S.a)({},e),{},{type:"showWelcome"})),n(pe("Ready")),n(le([{type:v},{type:h}])),me(a()).showWelcomeScreen()}catch(r){n(ue(r))}case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},Ke=function(e){return{type:"appendBuffer",payload:e}},Be=function(e){return e.buffer},Fe=function(e){return e.transactions},Ue=Object(ne.a)(Fe,(function(e){var t=e.data;return Object.values(t)})),qe=Object(ne.a)(Fe,(function(e){var t=e.active;return e.data[t]})),We=Object(ne.a)(qe,(function(e){return null===e||void 0===e?void 0:e.type})),He=Object(ne.a)(qe,(function(e){return((null===e||void 0===e?void 0:e.amount)||0)+((null===e||void 0===e?void 0:e.tipAmount)||0)})),Je=Object(ne.a)(Ue,(function(e){return e.filter((function(e){return e.payment}))})),Ge=Object(ne.a)(Je,(function(e){return e.filter((function(e){return e.visible}))})),Xe=Object(ne.a)(Fe,(function(e){return e.mode})),ze=function(e){return function(){var t=Object(W.a)(q.a.mark((function t(n,a){var r,c,o,i,s,u,l,d,m,p;return q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Le;case 3:if(r=t.sent,n(Object(S.a)(Object(S.a)({},e),{},{type:"transaction"})),c=a(),o=Be(c),i=me(c),s=oe(c),u=Xe(c),n({type:"clearActions"}),n(pe("Processing...")),n({type:"clearBuffer"}),l=+o){t.next=16;break}throw new Error("Amount is required");case 16:if(!isNaN(l)){t.next=18;break}throw new Error("Amount is invalid");case 18:if(!(l<=0||l>9999999)){t.next=20;break}throw new Error("Amount is invalid");case 20:d=L.a.CloverID.getNewId(),u===w&&(d=d.slice(0,12)),n(Te({id:d,type:u,amount:l})),t.t0=u,t.next=t.t0===D?26:t.t0===w?33:40;break;case 26:return(m=new L.a.remotepay.SaleRequest).setAmount(l),m.setExternalId(d),m.setCardEntryMethods(s),n(Ie({id:d,type:D,amount:l})),i.sale(m),t.abrupt("break",41);case 33:return(p=new L.a.remotepay.ManualRefundRequest).setAmount(l),p.setExternalId(d),p.setCardEntryMethods(s),n(Ie({id:d,type:w,amount:l})),i.manualRefund(p),t.abrupt("break",41);case 40:throw new Error("".concat(r("ERROR~Invalid transaction type"),": ").concat(u));case 41:t.next=47;break;case 43:t.prev=43,t.t1=t.catch(0),n(ue(t.t1)),n({type:"@@connector/onDeviceReady"});case 47:case"end":return t.stop()}}),t,null,[[0,43]])})));return function(e,n){return t.apply(this,arguments)}}()},Ze=function(e){return function(){var t=Object(W.a)(q.a.mark((function t(n,a){var r,c,o,i,s,u,l;return q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n({type:"voidPayment",payload:e}),r=e.id,c=e.externalPaymentId,o=e.orderId,i=e.amount,s=e.tipAmount,u=me(a()),n({type:"clearActions"}),n(pe("Processing\u2026")),r){t.next=8;break}throw new Error("No payment was specified");case 8:n(Te({id:c,type:T,amount:i,tipAmount:s})),(l=new L.a.remotepay.VoidPaymentRequest).setPaymentId(r),l.setOrderId(o),l.setVoidReason(L.a.order.VoidReason.USER_CANCEL),u.voidPayment(l),t.next=21;break;case 17:t.prev=17,t.t0=t.catch(0),n(ue(t.t0)),n({type:"@@connector/onDeviceReady"});case 21:case"end":return t.stop()}}),t,null,[[0,17]])})));return function(e,n){return t.apply(this,arguments)}}()};try{a=JSON.parse(localStorage.getItem("clover/virtual-keypad"))}catch(Bt){console.warn("Failed to initialize state from storage",Bt)}finally{a=a||void 0}var $e=function(e){var t=Object(A.a)(I.a),n=window.__REDUX_DEVTOOLS_EXTENSION__,a=n?n():function(e){return e};return Object(A.e)(te,e,Object(A.d)(t,a))}(a),Qe=$e.getState();if(ie(Qe)){var et=ae(Qe);$e.dispatch(Ee(et))}var tt,nt=$e,at=n(11),rt=function(e){return e.actions},ct=Object(ne.a)(rt,(function(e){return e.find((function(e){return e.type===h}))})),ot=Object(ne.a)(rt,(function(e){var t=e.filter((function(e){return e.type!==h}));if(2===t.length){var n,a,r=Object(at.a)(t,2),c=r[0],o=r[1];if("No"===(null===(n=c.payload)||void 0===n?void 0:n.description)&&"Yes"===(null===(a=o.payload)||void 0===a?void 0:a.description))return[o,c]}return t})),it=function(e){return e.signature},st=Object(ne.a)(it,(function(e){var t=e.strokes.map((function(e){return e.points})).flat().reduce((function(e,t){var n=e.x,a=e.X,r=e.y,c=e.Y;return{x:Math.min(n,t.x),X:Math.max(a,t.x),y:Math.min(r,t.y),Y:Math.max(c,t.y)}}),{x:1/0,X:-1/0,y:1/0,Y:-1/0});return[t.x,t.y,t.X-t.x,t.Y-t.y].join(" ")})),ut=Object(ne.a)(it,(function(e){return e.strokes.map((function(e){return e.points.map((function(e){var t=e.x,n=e.y;return"".concat(t,",").concat(n)})).join(" ")}))})),lt=function(e){return e.status},dt=n(20),mt=n.n(dt),pt=n(612),vt=n(139),ft=n.n(vt),bt=Object(ne.a)(me,ke,(function(e,t){return!e&&!t.length})),yt=function(e){var t=e.size,n=void 0===t?28:t,a=Object(pt.a)().t;return c.a.createElement("svg",{className:"Logo",id:"clover-logo-svg",xmlns:"http://www.w3.org/2000/svg",width:n,height:n,viewBox:"0 0 33.15 33.15","aria-labelledby":"svg-logo-title",role:"image"},c.a.createElement("title",{id:"svg-logo-title"},a("Clover")),c.a.createElement("g",{id:"clover-symbol-2","data-name":"clover-symbol"},c.a.createElement("path",{d:"M191.45,85.64A7.5,7.5,0,1,0,184,93.09h7.49V85.64Z",transform:"translate(-176.46 -77.01)"}),c.a.createElement("path",{d:"M193.61,85.64a7.5,7.5,0,1,1,7.49,7.45h-7.49V85.64Z",transform:"translate(-176.46 -77.01)"}),c.a.createElement("path",{d:"M193.61,102.7a7.5,7.5,0,1,0,7.49-7.45h-7.49v7.45Z",transform:"translate(-176.46 -77.01)"}),c.a.createElement("path",{d:"M191.46,102.7A7.5,7.5,0,1,1,184,95.25h7.49v7.45Zm-7.5,5.35a5.38,5.38,0,0,0,5.4-5.35V97.36H184a5.35,5.35,0,1,0,0,10.7h0Z",transform:"translate(-176.46 -77.01)"})))},Et=function(){var e=Object(pt.a)().t,t=Object(s.b)(),n=Object(s.c)(ae),a=Object(s.c)(se),o=Object(s.c)(bt),i=ft.a.parse(window.location.search),u=ft.a.parse(window.location.hash),l=Object(r.useState)(n.cloverDomain||"https://www.clover.com"),d=Object(at.a)(l,2),m=d[0],p=d[1],v=Object(r.useState)(i.merchant_id||n.merchantId),f=Object(at.a)(v,2),b=f[0],y=f[1],E=Object(r.useState)(u.access_token||n.accessToken),O=Object(at.a)(E,2),h=O[0],j=O[1],g=Object(r.useState)(n.friendlyId||e("Virtual Keypad")),C=Object(at.a)(g,2),N=C[0],k=C[1],D=Object(r.useState)(n.manualCardEntry||!1),w=Object(at.a)(D,2),T=w[0],A=w[1],I=Object(r.useState)(n.autoConnect||!1),x=Object(at.a)(I,2),R=x[0],S=x[1],P=Object(r.useState)(!1),M=Object(at.a)(P,2),L=M[0],_=M[1],V=Object(r.useMemo)((function(){return a||L}),[a,L]),Y=Object(r.useCallback)(function(){var e=Object(W.a)(q.a.mark((function e(n){return q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n.preventDefault(),_(!0),e.next=5,t(Ee({cloverDomain:m,merchantId:b,accessToken:h,friendlyId:N,manualCardEntry:T,autoConnect:R}));case 5:return e.prev=5,_(!1),e.finish(5);case 8:case"end":return e.stop()}}),e,null,[[0,,5,8]])})));return function(t){return e.apply(this,arguments)}}(),[t,m,b,h,N,T,R]),K=Object(r.useCallback)((function(e){e.preventDefault(),p(n.cloverDomain),y(n.merchantId),j(n.accessToken),k(n.friendlyId),A(n.manualCardEntry),S(n.autoConnect)}),[n,p,y,j,k,A,S]);return o?c.a.createElement("form",{onSubmit:Y,onReset:K},c.a.createElement("div",{className:"Configuration card"},c.a.createElement("div",{className:"card-header"},c.a.createElement(yt,null),c.a.createElement("h3",null,e("Virtual Keypad"))),c.a.createElement("div",{className:"card-body"},c.a.createElement("div",{className:"form-group"},c.a.createElement("label",null,e("Clover Domain"),":"),c.a.createElement("input",{type:"text",className:"form-control",value:m,onChange:function(e){return p(e.target.value)},disabled:V})),c.a.createElement("div",{className:"form-group"},c.a.createElement("label",null,e("Merchant ID"),":"),c.a.createElement("input",{type:"text",className:"form-control",value:b,onChange:function(e){return y(e.target.value)},disabled:V})),c.a.createElement("div",{className:"form-group"},c.a.createElement("label",null,e("Access Token"),":"),c.a.createElement("input",{type:"text",className:"form-control",value:h,onChange:function(e){return j(e.target.value)},disabled:V})),c.a.createElement("div",{className:"form-group"},c.a.createElement("label",null,e("Friendly ID"),":"),c.a.createElement("input",{type:"text",className:"form-control",value:N,onChange:function(e){return k(e.target.value)},disabled:V})),c.a.createElement("div",{className:"form-group"},c.a.createElement("div",{className:"custom-control custom-switch"},c.a.createElement("input",{id:"chkManualCardEntry",type:"checkbox",className:"custom-control-input",disabled:V,checked:T,onChange:function(){return A(!T)}}),c.a.createElement("label",{className:"custom-control-label font-weight-normal",htmlFor:"chkManualCardEntry"},e("Allow Manual Card Entry")))),c.a.createElement("div",{className:"form-group"},c.a.createElement("div",{className:"custom-control custom-switch"},c.a.createElement("input",{id:"chkAutoConnect",type:"checkbox",className:"custom-control-input",disabled:V,checked:R,onChange:function(){return S(!R)}}),c.a.createElement("label",{className:"custom-control-label font-weight-normal",htmlFor:"chkAutoConnect"},e("Auto-connect"))))),c.a.createElement("div",{className:"card-footer"},c.a.createElement("button",{type:"submit",className:"btn btn-success",disabled:V},e("Submit")),c.a.createElement("button",{type:"reset",className:"btn btn-secondary ml-2",disabled:V},e("Reset"))))):null},Ot=Object(ne.a)(me,ke,(function(e,t){return!e&&!!t.length})),ht=function(e){var t=e.device,n=e.active,a=e.disabled,r=e.onClick,o=Object(pt.a)().t,i=t.apps[g],s=o(i?"Cloud Pay Display is installed":"Cloud Pay Display is NOT installed");return c.a.createElement("button",{key:t.id,type:"button",className:mt()("list-group-item d-flex justify-content-between align-items-center list-group-item-action p-1",{disabled:a,"list-group-item-primary":!a&&n}),onClick:r},c.a.createElement("div",{className:"p-1"},t.name&&c.a.createElement("div",{className:"font-weight-bold"},t.name),t.productName," ",t.serial),c.a.createElement("span",{className:mt()("badge p-1",{"badge-secondary":a,"badge-success":!a&&i,"badge-warning":!a&&!i}),role:"img","aria-label":s,title:s},"\u2601\ufe0f"))},jt=function(){var e=Object(pt.a)().t,t=Object(s.b)(),n=Object(s.c)(ke),a=Object(s.c)(Ne),o=Object(s.c)(Ot),i=Object(r.useState)(),u=Object(at.a)(i,2),l=u[0],d=u[1],m=Object(r.useCallback)((function(e){return function(){var n=Object(W.a)(q.a.mark((function n(a){return q.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,a.preventDefault(),d(!0),n.next=5,t(we(e));case 5:return n.prev=5,d(!1),n.finish(5);case 8:case"end":return n.stop()}}),n,null,[[0,,5,8]])})));return function(e){return n.apply(this,arguments)}}()}),[t]);return o?c.a.createElement("div",{className:"Devices card"},c.a.createElement("div",{className:"card-header"},c.a.createElement(yt,null),c.a.createElement("h3",null,e("Virtual Keypad")),c.a.createElement("button",{className:"close text-light",title:e("Cancel"),onClick:function(){return t({type:"clearDevices"})},disabled:l},"\xd7")),c.a.createElement("div",{className:"card-body"},c.a.createElement("div",{className:"form-group"},c.a.createElement("label",null,e("Select Devices"),":"),c.a.createElement("div",{className:"list-group"},n.map((function(e){return c.a.createElement(ht,{key:e.id,device:e,disabled:l,active:e.id===a,onClick:m(e.id)})})))))):null},gt=(tt={},Object(l.a)(tt,d,(function(e){return function(){var t=Object(W.a)(q.a.mark((function t(n,a){return q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{n(Object(S.a)(Object(S.a)({},e),{},{type:"acceptPayment"})),n(pe("Accepting payment\u2026")),n({type:"clearActions"}),me(a()).acceptPayment(e.payload.payment)}catch(Bt){n(ue(Bt))}case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()})),Object(l.a)(tt,m,(function(e){return function(){var t=Object(W.a)(q.a.mark((function t(n,a){var r,c;return q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{n(Object(S.a)(Object(S.a)({},e),{},{type:"acceptSignature"})),n(pe("Accepting signature\u2026")),n({type:"clearActions"}),n({type:"clearSignature"}),r=me(a()),(c=new L.a.remotepay.VerifySignatureRequest).setPayment(e.payload.payment),r.acceptSignature(c)}catch(Bt){n(ue(Bt))}case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()})),Object(l.a)(tt,p,xe),Object(l.a)(tt,v,(function(e){return function(){var t=Object(W.a)(q.a.mark((function t(n,a){var r,c,o,i;return q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Le;case 3:r=t.sent,n(Object(S.a)(Object(S.a)({},e),{},{type:"identify"})),n(pe("Identifying\u2026")),n(le([{type:O,payload:{description:"OK"}},{type:p,payload:{description:"Cancel"}}])),c=a(),o=me(c),i=re(c),o.showMessage("".concat(i," ").concat(r("connected"))),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),n(ue(t.t0));case 16:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(e,n){return t.apply(this,arguments)}}()})),Object(l.a)(tt,f,(function(e){return function(){var t=Object(W.a)(q.a.mark((function t(n,a){var r,c;return q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{n(Object(S.a)(Object(S.a)({},e),{},{type:"invokeInputOption"})),r=me(a()),(c=new L.a.remotepay.InputOption).setDescription(e.payload.description),c.setKeyPress(e.payload.keyPress),r.invokeInputOption(c)}catch(Bt){n(ue(Bt))}case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()})),Object(l.a)(tt,b,(function(e){return function(){var t=Object(W.a)(q.a.mark((function t(n,a){return q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{n(Object(S.a)(Object(S.a)({},e),{},{type:"rejectPayment"})),n(pe("Rejecting payment\u2026")),n({type:"clearActions"}),me(a()).rejectPayment(e.payload.payment,e.payload.challenges[0])}catch(Bt){n(ue(Bt))}case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()})),Object(l.a)(tt,y,(function(e){return function(){var t=Object(W.a)(q.a.mark((function t(n,a){var r,c;return q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{n(Object(S.a)(Object(S.a)({},e),{},{type:"rejectSignature"})),n(pe("Rejecting signature\u2026")),n({type:"clearActions"}),n({type:"clearSignature"}),r=me(a()),(c=new L.a.remotepay.VerifySignatureRequest).setPayment(e.payload.payment),r.rejectSignature(c)}catch(Bt){n(ue(Bt))}case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()})),Object(l.a)(tt,E,_e),Object(l.a)(tt,O,Ye),Object(l.a)(tt,h,ze),Object(l.a)(tt,j,(function(e){var t=e.payload;return{type:"setTransactionMode",payload:t.mode}})),tt),Ct={TRANSACTION:"TRANSACTION",HISTORY:"HISTORY"},Nt=Object(ne.a)(me,(function(e){return!!e})),kt=n(613),Dt=function(e){var t=e.width,n=void 0===t?250:t,a=Object(H.a)(e,["width"]),r=Object(s.c)(st),o=Object(s.c)(ut);return o.length?c.a.createElement("div",{className:"Signature"},c.a.createElement("svg",Object.assign({viewBox:r,width:n},a),o.map((function(e,t){return c.a.createElement("polyline",{key:t,points:e,fill:"none",stroke:"black"})})))):null},wt=function(){var e=Object(pt.a)().t,t=Object(s.c)(lt),n=Object(s.c)(Be),a=Object(s.c)(We),o=Object(s.c)(He),i=Object(r.useMemo)((function(){var n=t.match(/^Partial authorization for (.+)\nContinue with transaction\?$/);if(n){var a=Object(at.a)(n,2)[1];return c.a.createElement(kt.a,{i18nKey:"STATUS~Partial authorization",amount:a},"Partial authorization for ",{amount:a},"Continue with transaction?")}var r=t.match(/^Processing Card ending in (\d+)\u2026$/);if(r){var o=Object(at.a)(r,2)[1];return c.a.createElement(kt.a,{i18nKey:"STATUS~Processing card ending",last4:o},"Processing Card ending in ",{last4:o},"\u2026")}return e(["STATUS~".concat(t),t])}),[t,e]);return c.a.createElement("div",{className:"Screen alert alert-secondary"},!!o&&c.a.createElement("div",{className:"Transaction d-flex justify-content-between bg-white rounded-top border-bottom border-secondary"},c.a.createElement("div",{className:"font-italic"},e(["TRANSACTION~".concat(a),a])),c.a.createElement("div",{className:"font-weight-bold"},Q(o))),!n&&c.a.createElement("div",null,i),c.a.createElement(Dt,null),n&&c.a.createElement("div",{className:"text-muted"},n),n&&c.a.createElement("h3",{className:"text-right"},Q(n)))},Tt=n(278),At=Object(r.forwardRef)((function(e,t){var n=e.action,a=e.height,o=e.color,i=e.keyCodes,s=e.disabled,u=e.onClick,l=e.moreActions,d=e.moreText,m=e.onMoreClick,p=e.children,v=Object(H.a)(e,["action","height","color","keyCodes","disabled","onClick","moreActions","moreText","onMoreClick","children"]),f=Object(pt.a)().t,b=Object(r.useState)(!1),y=Object(at.a)(b,2),E=y[0],O=y[1];Object(r.useEffect)((function(){if(E){var e=function(){return O(!1)};return document.addEventListener("click",e),document.addEventListener("touch",e),document.addEventListener("keydown",e),function(){document.removeEventListener("click",e),document.removeEventListener("touch",e),document.removeEventListener("keydown",e)}}}),[E]),Object(r.useEffect)((function(){if(!s){var e=function(e){return!i.includes(e.code)||(e.preventDefault(),u(),!1)};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}}),[s,i,u]);var h=Object(r.useMemo)((function(){var e,t=(null===n||void 0===n||null===(e=n.payload)||void 0===e?void 0:e.description)||(null===n||void 0===n?void 0:n.type);return t?f(["ACTION~".concat(t),t]):p}),[n,p,f]),j=Object(r.useMemo)((function(){return"".concat(f("Shortcut keys"),": ").concat(i.map((function(e){return f(["KEY_CODE~".concat(e),e])})).join(", "))}),[i,f]);return n&&(null===l||void 0===l?void 0:l.length)?c.a.createElement("div",{className:"btn-group"},c.a.createElement("button",Object.assign({type:"button",className:"btn btn-dark action rounded-left",onClick:u,disabled:s},v,{title:j}),h||c.a.createElement("span",null,"\xa0")),c.a.createElement("button",{type:"button",className:"btn btn-dark action dropdown-toggle",onClick:function(){return O(!E)},disabled:s}),c.a.createElement("div",{className:mt()("dropdown-menu bg-dark",{show:E})},l.map((function(e,t){var n,a;return c.a.createElement("button",{key:t,className:"dropdown-item bg-dark text-light",onClick:function(){return m(e)}},f(["ACTION~".concat((null===(n=e.payload)||void 0===n?void 0:n.description)||e.type),(null===(a=e.payload)||void 0===a?void 0:a.description)||e.type]))})))):(null===l||void 0===l?void 0:l.length)?c.a.createElement("div",{className:"btn-group-vertical d-flex flex-column"},c.a.createElement("div",{className:"btn-group dropdown"},c.a.createElement("button",{type:"button",className:mt()("btn btn-sm btn-outline-dark dropdown-toggle text-light"),onClick:function(){return O(!E)},disabled:s},d),c.a.createElement("div",{className:mt()("dropdown-menu dropdown-menu-right bg-dark",{show:E})},l.map((function(e,t){var n,a;return c.a.createElement("button",{key:t,className:"dropdown-item bg-dark text-light",onClick:function(){return m(e)}},f(["ACTION~".concat((null===(n=e.payload)||void 0===n?void 0:n.description)||e.type),(null===(a=e.payload)||void 0===a?void 0:a.description)||e.type]))})))),c.a.createElement("button",Object.assign({type:"button",className:mt()("btn btn-outline-dark h-100","text-".concat(o||"light")),onClick:u,disabled:s},v,{title:j}),h||c.a.createElement("span",null,"\xa0"))):c.a.createElement("button",Object.assign({ref:t,type:"button",style:{height:a},className:mt()("btn","text-".concat(o||"light"),{action:n,"btn-dark":n,"btn-outline-dark":!n}),disabled:s,onClick:u,title:j},v),h)})),It=function(){var e=Object(pt.a)().t,t=Object(s.b)(),n=Object(s.c)(ot),a=Object(s.c)(ct),o=Object(s.c)(Xe),i=Object(r.useState)(!1),u=Object(at.a)(i,2),l=u[0],d=u[1],m=Object(r.useMemo)((function(){return!a||l}),[a,l]),p=Object(r.useCallback)(function(){var e=Object(W.a)(q.a.mark((function e(n){return q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),n.type!==f&&n.type!==j||setTimeout((function(){return d(!1)}),250),e.next=4,t(gt[n.type](n));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[t,d]),v=function(e){return Object(W.a)(q.a.mark((function t(){return q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",p(e));case 1:case"end":return t.stop()}}),t)})))};Object(r.useEffect)((function(){n.length&&d(!1)}),[d,n]);var b=Object(r.useRef)(),y=Object(r.useState)(),E=Object(at.a)(y,2),O=E[0],h=E[1];Object(r.useEffect)((function(){b.current&&h(b.current.offsetWidth)}),[b,h]);var g=Object(Tt.a)(n),C=g[0],N=g[1],k=g.slice(2);return c.a.createElement("div",{className:"Keys"},c.a.createElement("div",{className:"row no-gutters"},c.a.createElement("div",{className:"col-6 p-1"},c.a.createElement(At,{action:C||{},disabled:!C||l,keyCodes:["F1","NumpadDivide"],onClick:v(C)})),c.a.createElement("div",{className:"col-6 p-1"},c.a.createElement(At,{action:N||{},disabled:!N||l,keyCodes:["F2","NumpadMultiply"],onClick:v(N),moreActions:k,onMoreClick:function(e){return p(e)}}))),c.a.createElement("div",{className:"row no-gutters"},c.a.createElement("div",{className:"col-3 p-1"},c.a.createElement(At,{ref:b,height:O,disabled:m,keyCodes:["Numpad7","Digit7"],onClick:function(){return t(Ke("7"))}},e("KEY~7"))),c.a.createElement("div",{className:"col-3 p-1"},c.a.createElement(At,{disabled:m,keyCodes:["Numpad8","Digit8"],onClick:function(){return t(Ke("8"))}},e("KEY~8"))),c.a.createElement("div",{className:"col-3 p-1"},c.a.createElement(At,{disabled:m,keyCodes:["Numpad9","Digit9"],onClick:function(){return t(Ke("9"))}},e("KEY~9"))),c.a.createElement("div",{className:"col-3 p-1"},c.a.createElement(At,{color:"danger",disabled:m,keyCodes:["NumpadSubtract","Escape"],onClick:function(){return t({type:"clearBuffer"})}},e("KEY~X")))),c.a.createElement("div",{className:"row no-gutters"},c.a.createElement("div",{className:"col-3 p-1"},c.a.createElement(At,{height:O,disabled:m,keyCodes:["Numpad4","Digit4"],onClick:function(){return t(Ke("4"))}},e("KEY~4"))),c.a.createElement("div",{className:"col-3 p-1"},c.a.createElement(At,{disabled:m,keyCodes:["Numpad5","Digit5"],onClick:function(){return t(Ke("5"))}},e("KEY~5"))),c.a.createElement("div",{className:"col-3 p-1"},c.a.createElement(At,{disabled:m,keyCodes:["Numpad6","Digit6"],onClick:function(){return t(Ke("6"))}},e("KEY~6"))),c.a.createElement("div",{className:"col-3 p-1"},c.a.createElement(At,{color:"warning",disabled:m,keyCodes:["NumpadAdd","Backspace","Delete"],onClick:function(){return t({type:"undoBuffer"})}},e("KEY~<")))),c.a.createElement("div",{className:"row no-gutters"},c.a.createElement("div",{className:"col-9"},c.a.createElement("div",{className:"row no-gutters"},c.a.createElement("div",{className:"col-4 p-1"},c.a.createElement(At,{height:O,disabled:m,keyCodes:["Numpad1","Digit1"],onClick:function(){return t(Ke("1"))}},e("KEY~1"))),c.a.createElement("div",{className:"col-4 p-1"},c.a.createElement(At,{disabled:m,keyCodes:["Numpad2","Digit2"],onClick:function(){return t(Ke("2"))}},e("KEY~2"))),c.a.createElement("div",{className:"col-4 p-1"},c.a.createElement(At,{disabled:m,keyCodes:["Numpad3","Digit3"],onClick:function(){return t(Ke("3"))}},e("KEY~3")))),c.a.createElement("div",{className:"row no-gutters"},c.a.createElement("div",{className:"col-8 p-1"},c.a.createElement(At,{height:O,disabled:m,keyCodes:["Numpad0","Digit0"],onClick:function(){return t(Ke("0"))}},e("KEY~0"))),c.a.createElement("div",{className:"col-4 p-1"},c.a.createElement(At,{disabled:m,keyCodes:["NumpadDecimal","Period"],onClick:function(){return t(Ke("00"))}},e("KEY~00"))))),c.a.createElement("div",{className:"col-3 p-1"},c.a.createElement(At,{color:"success",disabled:m,keyCodes:["NumpadEnter","Enter"],onClick:function(){return t(ze())},moreText:e(["TRANSACTION~".concat(o),o]),moreActions:[{type:j,payload:{description:"TRANSACTION~SALE",mode:D}},{type:j,payload:{description:"TRANSACTION~CREDIT",mode:w}}],onMoreClick:function(e){return p(e)}},e("KEY~O")))))},xt=function(e){var t=e.mode,n=e.setMode,a=Object(pt.a)().t,o=Object(s.b)(),i=Object(r.useState)(!1),u=Object(at.a)(i,2),l=u[0],d=u[1],m=Object(r.useCallback)((function(){return d(!l)}),[l,d]),p=Object(r.useCallback)((function(){return o(Ye())}),[o]),v=Object(r.useCallback)((function(){return o(_e())}),[o]),f=Object(r.useCallback)((function(){return o(xe())}),[o]);return Object(r.useEffect)((function(){if(l){var e=function(){return d(!1)};return document.addEventListener("click",e),document.addEventListener("touch",e),document.addEventListener("keydown",e),function(){document.removeEventListener("click",e),document.removeEventListener("touch",e),document.removeEventListener("keydown",e)}}}),[l,d]),c.a.createElement("div",{className:"dropdown"},c.a.createElement("button",{type:"button",className:"btn btn-sm btn-outline-dark text-light",onClick:m,title:a("Menu")},"\u2630"),c.a.createElement("div",{className:mt()("dropdown-menu dropdown-menu-right",{show:l})},Object.values(Ct).map((function(e){return c.a.createElement("button",{key:e,className:"dropdown-item",type:"button",onClick:function(){return n(e)}},c.a.createElement("div",{className:"custom-control custom-checkbox"},c.a.createElement("input",{type:"checkbox",className:"custom-control-input",id:"chkMode-".concat(e),checked:e===t,readOnly:!0}),c.a.createElement("label",{className:"custom-control-label",htmlFor:"chkMode-".concat(e)},a(["MODE~".concat(e),e]))))})),c.a.createElement("div",{className:"dropdown-divider"}),c.a.createElement("button",{className:"dropdown-item",type:"button",onClick:p},a("Show Welcome")),c.a.createElement("button",{className:"dropdown-item",type:"button",onClick:v},a("Reset Device")),c.a.createElement("button",{className:"dropdown-item",type:"button",onClick:f},a("Disconnect"))))},Rt=n(615),St=n(614),Pt=function(e){var t=e.amount,n=e.tipAmount,a=e.payment,r=(t||0)+(n||0),c=((null===a||void 0===a?void 0:a.amount)||0)+((null===a||void 0===a?void 0:a.tipAmount)||0);return{start:r,final:c,partial:r>c,remaining:r-c}},Mt=function(e){var t,n,a=e.transaction,r=a||{},o=r.type,i=r.payment,l=Object(pt.a)().t,d=Object(s.b)(),m=Object(u.useToasts)().removeToast,p=Pt(a),v=function(){var e=Object(W.a)(q.a.mark((function e(){return q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d({type:"setBuffer",payload:p.remaining||""});case 3:return e.next=5,d(ze());case 5:e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(0),e.next=11,d(ue(e.t0));case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),f=function(){var e=Object(W.a)(q.a.mark((function e(){return q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,m(a.id),e.next=4,d(Ae(a.id));case 4:return e.next=6,d(Ze(i));case 6:e.next=12;break;case 8:return e.prev=8,e.t0=e.catch(0),e.next=12,d(ue(e.t0));case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return c.a.createElement("div",{className:"Transaction"},a.type!==T&&p.partial&&c.a.createElement("div",{className:"alert alert-warning"},c.a.createElement("h6",{className:"alert-heading"},l("Partial Payment")),c.a.createElement("div",null,l("Remaining"),": ",Q(p.remaining))),c.a.createElement("h5",null,l(["TRANSACTION~".concat(o),o])," ",l("Details")),c.a.createElement("table",{className:"table table-sm small mb-0"},c.a.createElement("tbody",null,c.a.createElement("tr",null,c.a.createElement("th",null,l("Payment ID"),":"),c.a.createElement("td",null,i.id)),i.externalPaymentId&&c.a.createElement("tr",null,c.a.createElement("th",null,l("External ID"),":"),c.a.createElement("td",null,i.externalPaymentId)),i.externalReferenceId&&c.a.createElement("tr",null,c.a.createElement("th",null,l("External Ref"),":"),c.a.createElement("td",null,i.externalReferenceId)),c.a.createElement("tr",null,c.a.createElement("th",null,l("Order ID"),":"),c.a.createElement("td",null,(null===(t=i.order)||void 0===t?void 0:t.id)||(null===(n=i.orderRef)||void 0===n?void 0:n.id))),!!i.tipAmount&&c.a.createElement("tr",null,c.a.createElement("th",null,l("Total"),":"),c.a.createElement("td",null,Q(i.amount+i.tipAmount))),c.a.createElement("tr",null,c.a.createElement("th",null,l("Amount"),":"),c.a.createElement("td",null,Q(i.amount))),!!i.tipAmount&&c.a.createElement("tr",null,c.a.createElement("th",null,l("Tip"),":"),c.a.createElement("td",null,Q(i.tipAmount))),c.a.createElement("tr",null,c.a.createElement("th",null,l("Card"),":"),c.a.createElement("td",null,c.a.createElement("div",null,l(["CARD~".concat(i.cardTransaction.cardType),i.cardTransaction.cardType])),c.a.createElement("div",null,function(e){var t=e.first6,n=e.last4;return[t,"*".repeat(6),n].join("").replace(/.{4}/g," $&").trim()}(i.cardTransaction)),i.cardTransaction.cardholderName&&c.a.createElement("div",null,l(["CARDHOLDER_NAME~".concat(i.cardTransaction.cardholderName),i.cardTransaction.cardholderName])))))),a.type===D&&c.a.createElement("div",null,p.partial&&c.a.createElement("button",{className:"btn btn-primary btn-sm mr-1",onClick:v},l("Process")," ",Q(p.remaining)),c.a.createElement("button",{key:"void",className:"btn btn-danger btn-sm",onClick:f},l("Void"))))},Lt=function(){var e=Object(s.b)(),t=Object(u.useToasts)().addToast;return function(n){var a,r=Pt(n);a=n.type===T?"info":r.final>=r.start?"success":r.final<r.start?"warning":"info",t(c.a.createElement(Mt,{transaction:n}),{id:n.id,appearance:a,autoDismiss:!1,onDismiss:function(){e(Ae(n.id))}})}},_t=function(){var e=Object(pt.a)().t,t=Object(s.c)(Je),n=Lt(),a=Object(r.useMemo)((function(){return t.sort((function(e,t){return Object(St.a)(e.timestamp,t.timestamp)}))}),[t]);return c.a.createElement("div",{className:"History"},c.a.createElement("table",{className:"table table-sm table-hover table-secondary table-striped"},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null,e("Date")),c.a.createElement("th",null,e("Type")),c.a.createElement("th",{className:"text-right"},e("Amount")))),c.a.createElement("tbody",null,a.map((function(e){return c.a.createElement("tr",{key:e.id,role:"button",onClick:function(){return n(e)}},c.a.createElement("td",null,function(e){var t=e.timestamp;return t?Object(Rt.a)(t,"M/d h:mm a"):"??"}(e)),c.a.createElement("td",null,e.type),c.a.createElement("td",{className:"text-right"},function(e){var t=e.amount,n=e.tipAmount,a=e.payment;return Q(a?(a.amount||0)+(a.tipAmount||0):(t||0)+(n||0))}(e)))})))))},Vt=(n(608),function(){var e=Object(pt.a)().t,t=Object(s.c)(Nt),n=Object(r.useState)(Ct.TRANSACTION),a=Object(at.a)(n,2),o=a[0],i=a[1];return t?c.a.createElement("div",{className:"Keypad card"},c.a.createElement("div",{className:"card-header"},c.a.createElement(yt,null),c.a.createElement("h3",null,e("Virtual Keypad")),c.a.createElement(xt,{mode:o,setMode:i})),c.a.createElement("div",{className:"card-body"},o===Ct.TRANSACTION&&c.a.createElement(wt,null),o===Ct.TRANSACTION&&c.a.createElement(It,null),o===Ct.HISTORY&&c.a.createElement(_t,null))):null}),Yt=function(e){var t=e.error,n=t.message,a=t.stack,o=Object(pt.a)().t,i=Object(r.useState)(!1),s=Object(at.a)(i,2),u=s[0],l=s[1];return Object(r.useEffect)((function(){return function(){document.querySelectorAll(".Error.expanded").length-(u?1:0)||document.querySelector(".react-toast-notifications__container").classList.remove("expanded")}}),[u]),c.a.createElement("div",{className:mt()("Error",{expanded:u})},c.a.createElement("h5",null,o(["ERROR~".concat(n),n])),!!a&&!u&&c.a.createElement("button",{className:"btn btn-link btn-sm",onClick:function(){document.querySelector(".react-toast-notifications__container").classList.add("expanded"),l(!0)}},o("Show details")),!!a&&u&&c.a.createElement("pre",{className:"mb-0"},c.a.createElement("code",null,a)))},Kt=(n(609),function(){return function(e){var t=Object(s.b)(),n=Object(s.c)(Ve),a=Object(u.useToasts)().addToast;Object(r.useEffect)((function(){n.message&&a(c.a.createElement(Yt,{error:n}),{id:"error",appearance:"error",autoDismiss:e,onDismiss:function(){t({type:"clearError"})}})}),[a,t,n,e])}(function(){var e=Object(r.useState)(!1),t=Object(at.a)(e,2),n=t[0],a=t[1];return Object(r.useEffect)((function(){if(!n){var e=function(){return a(!0)};return document.addEventListener("mouseover",e),function(){return document.removeEventListener("mouseover",e)}}}),[n,a]),n}()),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.ms,n=void 0===t?500:t;Object(r.useEffect)((function(){var e=0,t=function(t){if(1===t.touches.length){var a=Date.now();1===t.touches.length&&a>e&&(t.preventDefault(),t.target.click()),e=a+n}};return document.body.addEventListener("touchstart",t,{passive:!1}),function(){return document.body.removeEventListener("touchstart",t,{passive:!1})}}),[n])}(),function(){var e=Object(s.c)(Ge),t=Lt();Object(r.useEffect)((function(){e.forEach(t)}),[e,t])}(),c.a.createElement("div",{className:mt()("App container maxwidth")},c.a.createElement(Et,null),c.a.createElement(jt,null),c.a.createElement(Vt,null))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(s.a,{store:nt},c.a.createElement(u.ToastProvider,{placement:"bottom-center"},c.a.createElement(Kt,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[283,1,2]]]);
//# sourceMappingURL=main.1f0feeda.chunk.js.map