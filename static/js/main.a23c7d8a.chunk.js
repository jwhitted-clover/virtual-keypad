(this["webpackJsonpvirtual-keypad"]=this["webpackJsonpvirtual-keypad"]||[]).push([[0],{293:function(e){e.exports=JSON.parse('{"translation":{"Virtual Keypad":"Virtual Keypad","Clover":"Clover","Clover Domain":"Clover Domain","Merchant ID":"Merchant ID","Access Token":"Access Token","Friendly ID":"Friendly ID","Allow Manual Card Entry":"Allow Manual Card Entry","Auto-connect":"Auto-connect","Submit":"Submit","Reset":"Reset","Cancel":"Cancel","Select Devices":"Select Devices","Cloud Pay Display is installed":"Cloud Pay Display is installed","Cloud Pay Display is NOT installed":"Cloud Pay Display is NOT installed","Show details":"Show details\u2026","Menu":"Menu","MODE":{"TRANSACTION":"Keypad","HISTORY":"History"},"Show Welcome":"Show Welcome","Reset Device":"Reset Device","Disconnect":"Disconnect","Date":"Date","Type":"Type","Amount":"Amount","ACTION":{"ACCEPT_PAYMENT":"Accept","ACCEPT_SIGNATURE":"Accept","DISCONNECT":"Disconnect","IDENTIFY":"Identify","INVOKE_INPUT_OPTION":"Invoke","REJECT_PAYMENT":"Reject","REJECT_SIGNATURE":"Reject","RESET":"Reset","SHOW_WELCOME":"Show Welcome","TRANSACTION":"Transaction","VOID_PAYMENT":"Void","CANCEL":"Cancel","OK":"OK","Type Card":"Type Card","Enter":"Enter","Clear":"Clear","Done":"Done","No receipt":"No receipt","Print":"Print","Yes":"Yes","No":"No"},"Shortcut keys":"Shortcut keys","KEY_CODE":{"Backspace":"Backspace","Delete":"Delete","Digit0":"Digit 0","Digit1":"Digit 1","Digit2":"Digit 2","Digit3":"Digit 3","Digit4":"Digit 4","Digit5":"Digit 5","Digit6":"Digit 6","Digit7":"Digit 7","Digit8":"Digit 8","Digit9":"Digit 9","Enter":"Enter","Escape":"Esc","F1":"F1","F2":"F2","Numpad0":"Numpad 0","Numpad1":"Numpad 1","Numpad2":"Numpad 2","Numpad3":"Numpad 3","Numpad4":"Numpad 4","Numpad5":"Numpad 5","Numpad6":"Numpad 6","Numpad7":"Numpad 7","Numpad8":"Numpad 8","Numpad9":"Numpad 9","NumpadAdd":"Numpad Add","NumpadDecimal":"Numpad Decimal","NumpadDivide":"Numpad Divide","NumpadEnter":"Numpad Enter","NumpadMultiply":"Numpad Multiply","NumpadSubtract":"Numpad Subtract","Period":"Period"},"KEY":{"0":"0","1":"1","2":"2","3":"3","4":"4","5":"5","6":"6","7":"7","8":"8","9":"9","00":"00","X":"X","<":"<","O":"O"},"TRANSACTION":{"SALE":"Sale","CREDIT":"Credit","VOID":"Void"},"Details":"Details","Partial Payment":"Partial Payment","Remaining":"Remaining","Payment ID":"Payment ID","External ID":"External ID","External Ref":"External Ref","Order ID":"Order ID","Total":"Total","Tip":"Tip","Card":"Card","CARD":{"VISA":"Visa","MC":"Mastercard","AMEX":"AmEx","DISCOVER":"Discover","DINERS_CLUB":"Diner\'s Club","JCB":"JCB","MAESTRO":"Maestro","SOLO":"Solo","LASER":"Laser","CHINA_UNION_PAY":"China Union Pay","CARTE_BLANCHE":"Carte Blanche","UNKNOWN":"Unknown","GIFT_CARD":"Gift Card","EBT":"EBT","GIROCARD":"Girocard","INTERAC":"Interac","OTHER":"Other"},"CARDHOLDER_NAME":{"MANUALLY ENTERED":"(manually entered)"},"Process":"Process","Void":"Void","ERROR":{"Amount is required":"Amount is required","Amount is invalid":"Amount is invalid","Merchant has no devices":"Merchant has no devices","Merchant has no devices with Cloud Pay Display installed":"Merchant has no devices with Cloud Pay Display installed","Device not found":"Device not found","Device does not have Cloud Pay Display installed":"Device does not have Cloud Pay Display installed","No payment was specified":"No payment was specified","Invalid transaction type":"Invalid transaction type"},"STATUS":{"Accepting payment\u2026":"Accepting payment\u2026","Accepting signature\u2026":"Accepting signature\u2026","Rejecting payment\u2026":"Rejecting payment\u2026","Rejecting signature\u2026":"Rejecting signature\u2026","Identifying\u2026":"Identifying\u2026","Connecting\u2026":"Connecting\u2026","Resetting\u2026":"Resetting\u2026","Processing...":"Processing\u2026","Processing\u2026":"Processing\u2026","Verify Signature":"Verify Signature","Customer is tipping\u2026":"Customer is tipping\u2026","Customer is choosing payment method\u2026":"Customer is choosing payment method\u2026","Ready":"Ready","Timed out":"Timed out","Card Number":"Card Number","Customer is signing\u2026":"Customer is signing\u2026","Customer is selecting receipt type\u2026":"Customer is selecting receipt type\u2026","CVV Security Code":"CVV Security Code","Expiration Date":"Expiration Date","Transaction failed: Error connecting to payment gateway. Please try again later":"Transaction failed: Error connecting to payment gateway. Please try again later","This may be a duplicate, do you want to accept this payment?":"This may be a duplicate, do you want to accept this payment?","Partial authorization":"Partial authorization for {{amount}}<br/>Continue with transaction?","Processing card ending":"Processing Card ending in {{last4}}\u2026"},"connected":"connected"}}')},305:function(e,t,a){e.exports=a(642)},640:function(e,t,a){},641:function(e,t,a){},642:function(e,t,a){"use strict";a.r(t);var n,r,c,o=a(0),i=a.n(o),l=a(35),s=a.n(l),u=a(7),d=a(43),m=a(16),p="ACCEPT_PAYMENT",f="ACCEPT_SIGNATURE",v="DISCONNECT",y="IDENTIFY",b="INVOKE_INPUT_OPTION",O="REJECT_PAYMENT",E="REJECT_SIGNATURE",h="RESET",g="SHOW_WELCOME",j="TRANSACTION",C="TRANSACTION_MODE",N="CLOUD_PAY_DISPLAY",k=Object(m.a)({},N,"Cloud Pay Display"),D=Object.fromEntries(Object.entries(k).map((function(e){return e.reverse()}))),w="https://www.clover.com",T=/^(Flex|Mini|Mobile)/i,A="clover/virtual-keypad",I="SALE",R="CREDIT",S="VOID",x=a(46),P=a(290),M=a(94),_=[],V=a(2),L=a(153),Y=a.n(L),K=Y.a.parse(window.location.search),F=Y.a.parse(window.location.hash),B=JSON.parse(atob(localStorage.getItem(A)||"bnVsbA==")),U={cloverDomain:function(){var e,t;if(null===B||void 0===B||null===(e=B.configuration)||void 0===e?void 0:e.cloverDomain)return null===B||void 0===B||null===(t=B.configuration)||void 0===t?void 0:t.cloverDomain;if(document.referrer){var a=new URL(document.referrer);if(a.origin.includes("clover.com"))return a.toString()}return w}(),merchantId:K.merchant_id||(null===B||void 0===B||null===(n=B.configuration)||void 0===n?void 0:n.merchantId)||"",accessToken:F.access_token||(null===B||void 0===B||null===(r=B.configuration)||void 0===r?void 0:r.accessToken)||"",friendlyId:"Virtual Keypad",loading:void 0},z=a(19),q=a.n(z),W={connector:null,connected:!1},H=function(e){var t=e.device.doTxStart;e.device.doTxStart=function(a,n,r){return"CREDIT"===r&&(a.externalReferenceId=a.externalPaymentId),t.call(e.device,a,n,r)}},J=function(e){try{null===e||void 0===e||e.dispose()}catch(t){}},G={list:[],selected:""},X={message:null,stack:null},Z={width:0,height:0,strokes:[]},$=a(6),Q=a.n($),ee=a(9),te=a(36),ae=function e(t,a){var n=a.retries,r=void 0===n?3:n,c=Object(te.a)(a,["retries"]);return fetch(t,c).catch((function(a){if(r>1)return e(t,Object(V.a)({retries:r-1},c));throw a}))},ne=function(e){var t=e.cloverDomain,a=e.merchantId,n=e.deviceId,r=e.accessToken;return ae(new URL("/v2/merchant/".concat(a,"/device/").concat(n,"/current_apps?access_token=").concat(r),t).toString(),{method:"GET",headers:{accept:"application/json","content-type":"application/json"}}).then((function(e){return e.json()}))},re=function(e){var t=e.cloverDomain,a=e.merchantId,n=e.accessToken;return ae(new URL("/v3/merchants/".concat(a,"/devices?access_token=").concat(n),t).toString(),{method:"GET",headers:{accept:"application/json","content-type":"application/json"}}).then((function(e){return e.json()}))},ce=function(e,t){var a=D[t.appName];return a?Object(V.a)(Object(V.a)({},e),{},Object(m.a)({},a,!0)):e},oe=function(e,t){return e.reduce((function(e,a){var n=e[e.length-1];return n.length===t?e.push([a]):n.push(a),e}),[[]])},ie=function(){var e=Object(ee.a)(Q.a.mark((function e(t){var a,n,r,c,o,i,l,s,u;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.cloverDomain,n=t.merchantId,r=t.accessToken,e.next=3,re({cloverDomain:a,merchantId:n,accessToken:r});case 3:c=e.sent,o=c.elements,i=o.filter((function(e){return T.test(e.productName)})),l=oe(i,4),s=0;case 8:if(!(s<l.length)){e.next=15;break}return e.next=11,Promise.all(l[s].map((function(e){var t=e.id;return ne({cloverDomain:a,merchantId:n,accessToken:r,deviceId:t})})));case 11:l[s]=e.sent;case 12:s++,e.next=8;break;case 15:return u=l.flat(),e.abrupt("return",i.map((function(e,t){return Object(V.a)(Object(V.a)({},e),{},{apps:u[t].applications.reduce(ce,{})})})));case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),le=function(e){var t=+e;return!isNaN(t)&&t>=0?(t/100).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):""},se={active:null,mode:I,data:{}},ue=Object(x.c)({actions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"clearActions":return _;case"appendActions":var r=e.some((function(e){var t,a;return e.type===n.type&&(null===(t=e.payload)||void 0===t?void 0:t.description)===(null===(a=n.payload)||void 0===a?void 0:a.description)}));return r?e:[].concat(Object(M.a)(e),[n]);case"setActions":return n||[];case"setConnector":return[{type:v,payload:{description:"Cancel"}}];case"@@connector/onDeviceReady":case"@@connector/onResetDeviceResponse":return[{type:y},{type:j}];case"@@connector/onDeviceActivityStart":return n.inputOptions.map((function(e){return{type:b,payload:e}}));case"@@connector/onSaleResponse":case"@@connector/onVoidPaymentResponse":case"@@connector/onManualRefundResponse":return[{type:y},{type:j}];case"@@connector/onConfirmPaymentRequest":return[{type:p,payload:n},{type:O,payload:n}];case"@@connector/onVerifySignatureRequest":return[{type:f,payload:n},{type:E,payload:n}];default:return e}},buffer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"clearBuffer":return"";case"appendBuffer":return(e+n).replace(/^0+/,"").slice(0,7);case"setBuffer":return n;case"undoBuffer":return e.length?e.slice(0,e.length-1):"";default:return e}},configuration:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"setConfigurationLoading":return Object(V.a)(Object(V.a)({},e),{},{loading:!0});case"setConfigurationNotLoading":return Object(V.a)(Object(V.a)({},e),{},{loading:void 0});case"setConfiguration":return Object(V.a)(Object(V.a)({},e),{},{cloverDomain:n.cloverDomain||"",merchantId:n.merchantId||"",accessToken:n.accessToken||"",friendlyId:n.friendlyId||""});default:return e}},connection:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"clearConnector":return J(e.connector),W;case"setConnector":return J(e.connector),Object(V.a)(Object(V.a)({},e),{},{connector:n,connected:!1});case"@@connector/onDeviceDisconnected":return Object(V.a)(Object(V.a)({},e),{},{connected:!1});case"@@connector/onDeviceReady":H(e.connector);var r=new q.a.remotepay.RetrieveDeviceStatusRequest;return r.setSendLastMessage(!0),e.connector.retrieveDeviceStatus(r),Object(V.a)(Object(V.a)({},e),{},{connected:!0});default:return e}},devices:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"clearDevices":return Object(V.a)(Object(V.a)({},e),{},{list:[]});case"clearDeviceId":return Object(V.a)(Object(V.a)({},e),{},{selected:""});case"setDeviceId":return Object(V.a)(Object(V.a)({},e),{},{selected:n||""});case"setDevices":return Object(V.a)(Object(V.a)({},e),{},{list:n||[]});default:return e}},error:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"clearError":return X;case"setError":return Object(V.a)(Object(V.a)({},e),{},{message:n.message,stack:n.stack});case"@@connector/onDeviceError":return Object(V.a)(Object(V.a)({},e),{},{message:"Device Error ".concat(n.message),stack:null});default:return e}},signature:function(){var e,t,a,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z,r=arguments.length>1?arguments[1]:void 0,c=r.type,o=r.payload;switch(c){case"clearSignature":return Z;case"setSignature":return{width:(null===o||void 0===o?void 0:o.width)||0,height:(null===o||void 0===o?void 0:o.height)||0,strokes:(null===o||void 0===o?void 0:o.strokes)||[]};case"@@connector/onVerifySignatureRequest":return{width:(null===(e=o.signature)||void 0===e?void 0:e.width)||0,height:(null===(t=o.signature)||void 0===t?void 0:t.height)||0,strokes:(null===(a=o.signature)||void 0===a?void 0:a.strokes)||[]};default:return n}},status:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"clearStatus":return"";case"setStatus":return n||"";case"@@connector/onDeviceReady":case"@@connector/onResetDeviceResponse":return"Ready";case"@@connector/onDeviceActivityStart":return n.message;case"@@connector/onSaleResponse":case"@@connector/onVoidPaymentResponse":case"@@connector/onManualRefundResponse":return"Ready";case"@@connector/onConfirmPaymentRequest":return n.challenges[0].message;case"@@connector/onVerifySignatureRequest":return"Verify Signature";default:return e}},transactions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:se,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"setTransactionMode":return Object(V.a)(Object(V.a)({},e),{},{mode:n});case"setActiveTransaction":if(n.id){var r=e.data[n.id]||{};return Object(V.a)(Object(V.a)({},e),{},{active:n.id,data:Object(V.a)(Object(V.a)({},e.data),{},Object(m.a)({},n.id,Object(V.a)(Object(V.a)({},e.data[n.id]),{},{id:n.id,timestamp:Date.now(),type:n.type||r.type,amount:n.amount||r.amount||0,tipAmount:n.tipAmount||r.tipAmount||0})))})}return Object(V.a)(Object(V.a)({},e),{},{active:""});case"hideTransaction":return Object(V.a)(Object(V.a)({},e),{},{data:Object(V.a)(Object(V.a)({},e.data),{},Object(m.a)({},n,Object(V.a)(Object(V.a)({},e.data[n]),{},{visible:!1})))});case"showTransaction":return Object(V.a)(Object(V.a)({},e),{},{data:Object(V.a)(Object(V.a)({},e.data),{},Object(m.a)({},n,Object(V.a)(Object(V.a)({},e.data[n]),{},{visible:!0})))});case"removeTransaction":var c=Object(V.a)(Object(V.a)({},e),{},{data:Object(V.a)({},e.data)});return delete c.data[n],c;case"updateTransaction":var o=e.data[n.id]||{};return Object(V.a)(Object(V.a)({},e),{},{data:Object(V.a)(Object(V.a)({},e.data),{},Object(m.a)({},n.id,Object(V.a)(Object(V.a)({},o),{},{id:n.id,timestamp:Date.now(),visible:n.visible||o.visible||!1,amount:n.amount||o.amount||0,tipAmount:n.tipAmount||o.tipAmount||0,type:n.type||o.type||"",payment:n.payment||o.payment||null})))});case"@@connector/onSaleResponse":return n.success?Object(V.a)(Object(V.a)({},e),{},{active:"",data:Object(V.a)(Object(V.a)({},e.data),{},Object(m.a)({},n.payment.externalPaymentId,Object(V.a)(Object(V.a)({},e.data[n.payment.externalPaymentId]),{},{id:n.payment.externalPaymentId,timestamp:Date.now(),visible:!0,type:I,payment:n.payment})))}):e;case"@@connector/onManualRefundResponse":return n.success?Object(V.a)(Object(V.a)({},e),{},{active:"",data:Object(V.a)(Object(V.a)({},e.data),{},Object(m.a)({},n.credit.externalReferenceId,Object(V.a)(Object(V.a)({},e.data[n.credit.externalReferenceId]),{},{id:n.credit.externalReferenceId,timestamp:Date.now(),visible:!0,type:R,payment:n.credit})))}):e;case"@@connector/onVoidPaymentResponse":return n.success?Object(V.a)(Object(V.a)({},e),{},{active:"",data:Object(V.a)(Object(V.a)({},e.data),{},Object(m.a)({},n.payment.externalPaymentId,Object(V.a)(Object(V.a)({},e.data[n.payment.externalPaymentId]),{},{id:n.payment.externalPaymentId,timestamp:Date.now(),visible:!0,type:S,payment:n.payment})))}):e;default:return e}}}),de=a(14),me=function(e){return e.configuration},pe=Object(de.a)(me,(function(e){return e.friendlyId||"Virtual Keypad"})),fe=Object(de.a)(me,(function(e){return e.cloverDomain===w})),ve=Object(de.a)(fe,(function(e){return e?q.a.CardEntryMethods.DEFAULT:q.a.CardEntryMethods.DEFAULT|q.a.CardEntryMethods.CARD_ENTRY_METHOD_MANUAL})),ye=Object(de.a)(me,(function(e){return e.loading||!1})),be=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.message,a=e.stack;return{type:"setError",payload:{message:t,stack:a}}},Oe=function(e){return{type:"setActions",payload:e}},Ee=function(e){return e.connection},he=Object(de.a)(Ee,(function(e){return e.connector})),ge=(Object(de.a)(Ee,(function(e){return e.connected})),function(e){return{type:"setStatus",payload:e}}),je=function(e){var t=e.configuration,a=e.devices;return localStorage.setItem(A,btoa(JSON.stringify({configuration:Object(V.a)(Object(V.a)({},t),{},{loading:void 0}),devices:Object(V.a)(Object(V.a)({},G),{},{selected:a.selected})})))},Ce=function(e){return{type:"setConfiguration",payload:{cloverDomain:e.cloverDomain,merchantId:e.merchantId,accessToken:e.accessToken,friendlyId:e.friendlyId}}},Ne=function(e){return{type:"setDeviceId",payload:e}},ke=function(e){return{type:"setDevices",payload:e}},De=function(e){var t=e.cloverDomain,a=e.merchantId,n=e.accessToken,r=e.friendlyId;return function(){var e=Object(ee.a)(Q.a.mark((function e(c,o){var i;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c({type:"configure",payload:{cloverDomain:t,merchantId:a,accessToken:n,friendlyId:r}}),e.next=4,c({type:"setConfigurationLoading"});case 4:return e.next=6,c(Ce({cloverDomain:t,merchantId:a,accessToken:n,friendlyId:r}));case 6:return je(o()),e.next=9,ie({cloverDomain:t,merchantId:a,accessToken:n});case 9:return i=e.sent,e.next=12,c(ke(i));case 12:if(i.length){e.next=14;break}throw new Error("Merchant has no devices");case 14:if(i.some((function(e){return e.apps[N]}))){e.next=16;break}throw new Error("Merchant has no devices with Cloud Pay Display installed");case 16:e.next=22;break;case 18:return e.prev=18,e.t0=e.catch(0),e.next=22,c(be(e.t0));case 22:return e.prev=22,e.next=25,c({type:"setConfigurationNotLoading"});case 25:return e.finish(22);case 26:case"end":return e.stop()}}),e,null,[[0,18,22,26]])})));return function(t,a){return e.apply(this,arguments)}}()},we=a(291),Te=a(90),Ae=a(303),Ie=a(302),Re=function(e){return e.devices},Se=Object(de.a)(Re,(function(e){return e.selected})),xe=Object(de.a)(Re,Se,(function(e,t){var a=e.list;return Object(M.a)(a).sort((function(e,a){return e.id===t?-1:a.id===t?1:0}))})),Pe=function(e){return{type:"setConnector",payload:e}},Me=function(e){return function(){var t=Object(ee.a)(Q.a.mark((function t(a,n){var r,c,o,i,l,s,u,d,p,f,v;return Q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,a({type:"connect",payload:e});case 3:return t.next=5,a(Ne(e));case 5:if(r=n(),je(r),c=me(r),o=c.cloverDomain,i=c.merchantId,l=c.accessToken,s=c.friendlyId,u=xe(r).find((function(t){return t.id===e}))){t.next=11;break}throw new Error("Device not found");case 11:if(u.apps[N]){t.next=13;break}throw new Error("Device does not have Cloud Pay Display installed");case 13:d=q.a.CloverConnectorFactoryBuilder.createICloverConnectorFactory(Object(m.a)({},q.a.CloverConnectorFactoryBuilder.FACTORY_VERSION,q.a.CloverConnectorFactoryBuilder.VERSION_12)),p=d.createICloverConnector(new q.a.WebSocketCloudCloverDeviceConfigurationBuilder("virtual-keypad",e,i,l).setCloverServer(o).setFriendlyId(s).build()),f=function(e){Object(Ae.a)(n,e);var t=Object(Ie.a)(n);function n(){var e;return Object(we.a)(this,n),e=t.call(this),Object.keys(Object.getPrototypeOf(Object.getPrototypeOf(Object(Te.a)(e)))).forEach((function(t){e[t]=function(e){return a({type:"@@connector/".concat(t),payload:e})}})),e}return n}(q.a.remotepay.ICloverConnectorListener),v=new f,p.addCloverConnectorListener(v),a(Pe(p)),a(ge("Connecting\u2026")),p.initializeConnection(),t.next=26;break;case 23:t.prev=23,t.t0=t.catch(0),a(be(t.t0));case 26:case"end":return t.stop()}}),t,null,[[0,23]])})));return function(e,a){return t.apply(this,arguments)}}()},_e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,a=e.type,n=e.amount,r=e.tipAmount;return{type:"setActiveTransaction",payload:{id:t,type:a,amount:n,tipAmount:r}}},Ve=function(e){return{type:"hideTransaction",payload:e}},Le=function(e){return{type:"updateTransaction",payload:{id:e.id,type:e.type,amount:e.amount,tipAmount:e.tipAmount,payment:e.payment}}},Ye=function(){return function(){var e=Object(ee.a)(Q.a.mark((function e(t,a){var n;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t({type:"disconnect"});case 3:return n=he(a()),e.prev=4,n.showWelcomeScreen(),e.next=8,new Promise((function(e){return setTimeout(e,500)}));case 8:e.next=12;break;case 10:e.prev=10,e.t0=e.catch(4);case 12:return n.dispose(),e.next=15,t({type:"clearConnector"});case 15:return e.next=17,t({type:"clearDevices"});case 17:return e.next=19,t(_e());case 19:e.next=25;break;case 21:return e.prev=21,e.t1=e.catch(0),e.next=25,t(be(e.t1));case 25:case"end":return e.stop()}}),e,null,[[0,21],[4,10]])})));return function(t,a){return e.apply(this,arguments)}}()},Ke=a(301),Fe=a(37),Be=a(292),Ue={en:a(293)},ze=Ke.a.use(Be.a).use(Fe.e).init({fallbackLng:"en",debug:!1,keySeparator:"~",nsSeparator:!1,interpolation:{escapeValue:!1},resources:Ue}),qe=function(e){return function(){var t=Object(ee.a)(Q.a.mark((function t(a,n){return Q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{a(Object(V.a)(Object(V.a)({},e),{},{type:"reset"})),a(ge("Resetting\u2026")),a({type:"clearActions"}),he(n()).resetDevice()}catch(r){a(be(r))}case 1:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()},We=function(e){return e.error},He=function(e){return function(){var t=Object(ee.a)(Q.a.mark((function t(a,n){return Q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{a(Object(V.a)(Object(V.a)({},e),{},{type:"showWelcome"})),a(ge("Ready")),a(Oe([{type:y},{type:j}])),he(n()).showWelcomeScreen()}catch(r){a(be(r))}case 1:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()},Je=function(e){return{type:"appendBuffer",payload:e}},Ge=function(e){return e.buffer},Xe=function(e){return e.transactions},Ze=Object(de.a)(Xe,(function(e){var t=e.data;return Object.values(t)})),$e=Object(de.a)(Xe,(function(e){var t=e.active;return e.data[t]})),Qe=Object(de.a)($e,(function(e){return null===e||void 0===e?void 0:e.type})),et=Object(de.a)($e,(function(e){return((null===e||void 0===e?void 0:e.amount)||0)+((null===e||void 0===e?void 0:e.tipAmount)||0)})),tt=Object(de.a)(Ze,(function(e){return e.filter((function(e){return e.payment}))})),at=Object(de.a)(tt,(function(e){return e.filter((function(e){return e.visible}))})),nt=Object(de.a)(Xe,(function(e){return e.mode})),rt=function(e){return function(){var t=Object(ee.a)(Q.a.mark((function t(a,n){var r,c,o,i,l,s,u,d,m,p;return Q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ze;case 3:if(r=t.sent,a(Object(V.a)(Object(V.a)({},e),{},{type:"transaction"})),c=n(),o=Ge(c),i=he(c),l=ve(c),s=nt(c),a({type:"clearActions"}),a(ge("Processing...")),a({type:"clearBuffer"}),u=+o){t.next=16;break}throw new Error("Amount is required");case 16:if(!isNaN(u)){t.next=18;break}throw new Error("Amount is invalid");case 18:if(!(u<=0||u>9999999)){t.next=20;break}throw new Error("Amount is invalid");case 20:d=q.a.CloverID.getNewId(),s===R&&(d=d.slice(0,12)),a(_e({id:d,type:s,amount:u})),t.t0=s,t.next=t.t0===I?26:t.t0===R?33:40;break;case 26:return(m=new q.a.remotepay.SaleRequest).setAmount(u),m.setExternalId(d),m.setCardEntryMethods(l),a(Le({id:d,type:I,amount:u})),i.sale(m),t.abrupt("break",41);case 33:return(p=new q.a.remotepay.ManualRefundRequest).setAmount(u),p.setExternalId(d),p.setCardEntryMethods(l),a(Le({id:d,type:R,amount:u})),i.manualRefund(p),t.abrupt("break",41);case 40:throw new Error("".concat(r("ERROR~Invalid transaction type"),": ").concat(s));case 41:t.next=47;break;case 43:t.prev=43,t.t1=t.catch(0),a(be(t.t1)),a({type:"@@connector/onDeviceReady"});case 47:case"end":return t.stop()}}),t,null,[[0,43]])})));return function(e,a){return t.apply(this,arguments)}}()},ct=function(e){return function(){var t=Object(ee.a)(Q.a.mark((function t(a,n){var r,c,o,i,l,s,u;return Q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,a({type:"voidPayment",payload:e}),r=e.id,c=e.externalPaymentId,o=e.orderId,i=e.amount,l=e.tipAmount,s=he(n()),a({type:"clearActions"}),a(ge("Processing\u2026")),r){t.next=8;break}throw new Error("No payment was specified");case 8:a(_e({id:c,type:S,amount:i,tipAmount:l})),(u=new q.a.remotepay.VoidPaymentRequest).setPaymentId(r),u.setOrderId(o),u.setVoidReason(q.a.order.VoidReason.USER_CANCEL),s.voidPayment(u),t.next=21;break;case 17:t.prev=17,t.t0=t.catch(0),a(be(t.t0)),a({type:"@@connector/onDeviceReady"});case 21:case"end":return t.stop()}}),t,null,[[0,17]])})));return function(e,a){return t.apply(this,arguments)}}()};try{c=JSON.parse(atob(localStorage.getItem(A)||"bnVsbA=="))||void 0}catch(ra){console.warn("Failed to initialize state from storage",ra)}finally{c=c||void 0}var ot=function(e){var t=Object(x.a)(P.a),a=window.__REDUX_DEVTOOLS_EXTENSION__,n=a?a():function(e){return e};return Object(x.e)(ue,e,Object(x.d)(t,n))}(c),it=me(ot.getState());ot.dispatch(De(it));var lt,st=ot,ut=a(18),dt=function(e){return e.actions},mt=Object(de.a)(dt,(function(e){return e.find((function(e){return e.type===j}))})),pt=Object(de.a)(dt,(function(e){var t=e.filter((function(e){return e.type!==j}));if(2===t.length){var a,n,r=Object(ut.a)(t,2),c=r[0],o=r[1];if("No"===(null===(a=c.payload)||void 0===a?void 0:a.description)&&"Yes"===(null===(n=o.payload)||void 0===n?void 0:n.description))return[o,c]}return t})),ft=function(e){return e.signature},vt=Object(de.a)(ft,(function(e){var t=e.strokes.map((function(e){return e.points})).flat().reduce((function(e,t){var a=e.x,n=e.X,r=e.y,c=e.Y;return{x:Math.min(a,t.x),X:Math.max(n,t.x),y:Math.min(r,t.y),Y:Math.max(c,t.y)}}),{x:1/0,X:-1/0,y:1/0,Y:-1/0});return[t.x,t.y,t.X-t.x,t.Y-t.y].join(" ")})),yt=Object(de.a)(ft,(function(e){return e.strokes.map((function(e){return e.points.map((function(e){var t=e.x,a=e.y;return"".concat(t,",").concat(a)})).join(" ")}))})),bt=function(e){return e.status},Ot=a(12),Et=a.n(Ot),ht=a(645),gt=a(646),jt=a(647),Ct=a(648),Nt=a(297),kt=a(644),Dt=Object(de.a)(he,xe,(function(e,t){return!e&&!t.length})),wt=function(e){var t=e.id,a=e.type,n=void 0===a?"text":a,r=e.label,c=e.value,o=e.disabled,l=e.onChange,s=Object(te.a)(e,["id","type","label","value","disabled","onChange"]);return i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:t},r,":"),i.a.createElement("input",Object.assign({id:t,type:n,className:"form-control",value:c,onChange:function(e){return l(e.target.value)},disabled:o},s)))},Tt=function(e){var t=e.id,a=e.label,n=e.checked,r=e.onChange,c=e.disabled,o=e.switch,l=e.mb0,s=Object(te.a)(e,["id","label","checked","onChange","disabled","switch","mb0"]);return i.a.createElement("div",{className:Et()("form-group",{"mb-0":l})},i.a.createElement("div",{className:Et()("custom-control",{"custom-switch":o,"custom-checkbox":!o})},i.a.createElement("input",Object.assign({id:t,type:"checkbox",className:"custom-control-input",checked:n,onChange:function(){return r(!n)},disabled:c},s)),i.a.createElement("label",{className:"custom-control-label font-weight-normal",htmlFor:t},a)))},At=function(e){var t=e.size,a=void 0===t?28:t,n=Object(kt.a)().t;return i.a.createElement("svg",{className:"Logo",id:"clover-logo-svg",xmlns:"http://www.w3.org/2000/svg",width:a,height:a,viewBox:"0 0 33.15 33.15","aria-labelledby":"svg-logo-title",role:"image"},i.a.createElement("title",{id:"svg-logo-title"},n("Clover")),i.a.createElement("g",{id:"clover-symbol-2","data-name":"clover-symbol"},i.a.createElement("path",{d:"M191.45,85.64A7.5,7.5,0,1,0,184,93.09h7.49V85.64Z",transform:"translate(-176.46 -77.01)"}),i.a.createElement("path",{d:"M193.61,85.64a7.5,7.5,0,1,1,7.49,7.45h-7.49V85.64Z",transform:"translate(-176.46 -77.01)"}),i.a.createElement("path",{d:"M193.61,102.7a7.5,7.5,0,1,0,7.49-7.45h-7.49v7.45Z",transform:"translate(-176.46 -77.01)"}),i.a.createElement("path",{d:"M191.46,102.7A7.5,7.5,0,1,1,184,95.25h7.49v7.45Zm-7.5,5.35a5.38,5.38,0,0,0,5.4-5.35V97.36H184a5.35,5.35,0,1,0,0,10.7h0Z",transform:"translate(-176.46 -77.01)"})))},It=function(){var e=Object(kt.a)().t,t=Object(u.b)(),a=Object(u.c)(me),n=Object(u.c)(ye),r=Object(u.c)(Dt),c=Object(o.useState)(a.cloverDomain),l=Object(ut.a)(c,2),s=l[0],d=l[1],m=Object(o.useState)(a.merchantId),p=Object(ut.a)(m,2),f=p[0],v=p[1],y=Object(o.useState)(a.accessToken),b=Object(ut.a)(y,2),O=b[0],E=b[1],h=Object(o.useState)(a.friendlyId),g=Object(ut.a)(h,2),j=g[0],C=g[1],N=Object(o.useState)(!1),k=Object(ut.a)(N,2),D=k[0],w=k[1],T=Object(o.useMemo)((function(){return n||D}),[n,D]),A=Object(o.useCallback)(function(){var e=Object(ee.a)(Q.a.mark((function e(a){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.preventDefault(),w(!0),e.next=5,t(De({cloverDomain:s,merchantId:f,accessToken:O,friendlyId:j}));case 5:return e.prev=5,w(!1),e.finish(5);case 8:case"end":return e.stop()}}),e,null,[[0,,5,8]])})));return function(t){return e.apply(this,arguments)}}(),[t,s,f,O,j]),I=Object(o.useCallback)((function(e){e.preventDefault(),d(a.cloverDomain),v(a.merchantId),E(a.accessToken),C(a.friendlyId)}),[a,d,v,E,C]);return r?i.a.createElement("form",{onSubmit:A,onReset:I},i.a.createElement(ht.a,{className:"Configuration"},i.a.createElement(gt.a,null,i.a.createElement(At,null),i.a.createElement("h3",null,e("Virtual Keypad"))),n&&i.a.createElement(jt.a,null,i.a.createElement("p",null,"Loading...")),!n&&i.a.createElement(i.a.Fragment,null,i.a.createElement(jt.a,null,i.a.createElement(wt,{id:"cloverDomain",type:"url",label:e("Clover Domain"),autoCorrect:"off",autoComplete:"off",autoCapitalize:"off",spellCheck:"false",value:s,onChange:d,disabled:T}),i.a.createElement(wt,{id:"merchantId",label:e("Merchant ID"),pattern:"^[a-zA-Z0-9]{13}$",autoCorrect:"off",autoComplete:"off",autoCapitalize:"off",spellCheck:"false",value:f,onChange:v,disabled:T}),i.a.createElement(wt,{id:"accessToken",label:e("Access Token"),pattern:"^[a-fA-F0-9]{8}(-?[a-fA-F0-9]{4}){3}-?[a-fA-F0-9]{12}$",autoCorrect:"off",autoComplete:"off",autoCapitalize:"off",spellCheck:"false",value:O,onChange:E,disabled:T}),i.a.createElement(wt,{id:"friendlyId",label:e("Friendly ID"),value:j,onChange:C,disabled:T})),i.a.createElement(Ct.a,null,i.a.createElement(Nt.a,{type:"submit",color:"success",disabled:T},e("Submit")),i.a.createElement(Nt.a,{type:"reset",color:"secondary",className:"ml-2",disabled:T},e("Reset")))))):null},Rt=Object(de.a)(he,xe,(function(e,t){return!e&&!!t.length})),St=function(e){var t=e.device,a=e.active,n=e.disabled,r=e.onClick,c=Object(kt.a)().t,o=t.apps[N],l=c(o?"Cloud Pay Display is installed":"Cloud Pay Display is NOT installed");return i.a.createElement("button",{key:t.id,type:"button",className:Et()("list-group-item d-flex justify-content-between align-items-center list-group-item-action p-1",{disabled:n,"list-group-item-primary":!n&&a}),onClick:r},i.a.createElement("div",{className:"p-1"},t.name&&i.a.createElement("div",{className:"font-weight-bold"},t.name),t.productName," ",t.serial),i.a.createElement("span",{className:Et()("badge p-1",{"badge-secondary":n,"badge-success":!n&&o,"badge-warning":!n&&!o}),role:"img","aria-label":l,title:l},"\u2601\ufe0f"))},xt=function(){var e=Object(kt.a)().t,t=Object(u.b)(),a=Object(u.c)(xe),n=Object(u.c)(Se),r=Object(u.c)(Rt),c=Object(o.useState)(),l=Object(ut.a)(c,2),s=l[0],d=l[1],m=Object(o.useCallback)((function(e){return function(){var a=Object(ee.a)(Q.a.mark((function a(n){return Q.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,n.preventDefault(),d(!0),a.next=5,t(Me(e));case 5:return a.prev=5,d(!1),a.finish(5);case 8:case"end":return a.stop()}}),a,null,[[0,,5,8]])})));return function(e){return a.apply(this,arguments)}}()}),[t]);return r?i.a.createElement(ht.a,{className:"Devices"},i.a.createElement(gt.a,null,i.a.createElement(At,null),i.a.createElement("h3",null,e("Virtual Keypad")),i.a.createElement("button",{className:"close text-light",title:e("Cancel"),onClick:function(){return t({type:"clearDevices"})},disabled:s},"\xd7")),i.a.createElement(jt.a,null,i.a.createElement("div",{className:"form-group"},i.a.createElement("label",null,e("Select Devices"),":"),i.a.createElement("div",{className:"list-group"},a.map((function(e){return i.a.createElement(St,{key:e.id,device:e,disabled:s,active:e.id===n,onClick:m(e.id)})})))))):null},Pt=(lt={},Object(m.a)(lt,p,(function(e){return function(){var t=Object(ee.a)(Q.a.mark((function t(a,n){return Q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{a(Object(V.a)(Object(V.a)({},e),{},{type:"acceptPayment"})),a(ge("Accepting payment\u2026")),a({type:"clearActions"}),he(n()).acceptPayment(e.payload.payment)}catch(ra){a(be(ra))}case 1:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()})),Object(m.a)(lt,f,(function(e){return function(){var t=Object(ee.a)(Q.a.mark((function t(a,n){var r,c;return Q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{a(Object(V.a)(Object(V.a)({},e),{},{type:"acceptSignature"})),a(ge("Accepting signature\u2026")),a({type:"clearActions"}),a({type:"clearSignature"}),r=he(n()),(c=new q.a.remotepay.VerifySignatureRequest).setPayment(e.payload.payment),r.acceptSignature(c)}catch(ra){a(be(ra))}case 1:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()})),Object(m.a)(lt,v,Ye),Object(m.a)(lt,y,(function(e){return function(){var t=Object(ee.a)(Q.a.mark((function t(a,n){var r,c,o,i;return Q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ze;case 3:r=t.sent,a(Object(V.a)(Object(V.a)({},e),{},{type:"identify"})),a(ge("Identifying\u2026")),a(Oe([{type:g,payload:{description:"OK"}},{type:v,payload:{description:"Cancel"}}])),c=n(),o=he(c),i=pe(c),o.showMessage("".concat(i," ").concat(r("connected"))),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),a(be(t.t0));case 16:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(e,a){return t.apply(this,arguments)}}()})),Object(m.a)(lt,b,(function(e){return function(){var t=Object(ee.a)(Q.a.mark((function t(a,n){var r,c;return Q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{a(Object(V.a)(Object(V.a)({},e),{},{type:"invokeInputOption"})),r=he(n()),(c=new q.a.remotepay.InputOption).setDescription(e.payload.description),c.setKeyPress(e.payload.keyPress),r.invokeInputOption(c)}catch(ra){a(be(ra))}case 1:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()})),Object(m.a)(lt,O,(function(e){return function(){var t=Object(ee.a)(Q.a.mark((function t(a,n){return Q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{a(Object(V.a)(Object(V.a)({},e),{},{type:"rejectPayment"})),a(ge("Rejecting payment\u2026")),a({type:"clearActions"}),he(n()).rejectPayment(e.payload.payment,e.payload.challenges[0])}catch(ra){a(be(ra))}case 1:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()})),Object(m.a)(lt,E,(function(e){return function(){var t=Object(ee.a)(Q.a.mark((function t(a,n){var r,c;return Q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{a(Object(V.a)(Object(V.a)({},e),{},{type:"rejectSignature"})),a(ge("Rejecting signature\u2026")),a({type:"clearActions"}),a({type:"clearSignature"}),r=he(n()),(c=new q.a.remotepay.VerifySignatureRequest).setPayment(e.payload.payment),r.rejectSignature(c)}catch(ra){a(be(ra))}case 1:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()})),Object(m.a)(lt,h,qe),Object(m.a)(lt,g,He),Object(m.a)(lt,j,rt),Object(m.a)(lt,C,(function(e){var t=e.payload;return{type:"setTransactionMode",payload:t.mode}})),lt),Mt={TRANSACTION:"TRANSACTION",HISTORY:"HISTORY"},_t=Object(de.a)(he,(function(e){return!!e})),Vt=a(649),Lt=function(e){var t=e.width,a=void 0===t?250:t,n=Object(te.a)(e,["width"]),r=Object(u.c)(vt),c=Object(u.c)(yt);return c.length?i.a.createElement("div",{className:"Signature"},i.a.createElement("svg",Object.assign({viewBox:r,width:a},n),c.map((function(e,t){return i.a.createElement("polyline",{key:t,points:e,fill:"none",stroke:"black"})})))):null},Yt=function(){var e=Object(kt.a)().t,t=Object(u.c)(bt),a=Object(u.c)(Ge),n=Object(u.c)(Qe),r=Object(u.c)(et),c=Object(o.useMemo)((function(){var a=t.match(/^Partial authorization for (.+)\nContinue with transaction\?$/);if(a){var n=Object(ut.a)(a,2)[1];return i.a.createElement(Vt.a,{i18nKey:"STATUS~Partial authorization",amount:n},"Partial authorization for ",{amount:n},"Continue with transaction?")}var r=t.match(/^Processing Card ending in (\d+)\u2026$/);if(r){var c=Object(ut.a)(r,2)[1];return i.a.createElement(Vt.a,{i18nKey:"STATUS~Processing card ending",last4:c},"Processing Card ending in ",{last4:c},"\u2026")}return e(["STATUS~".concat(t),t])}),[t,e]);return i.a.createElement("div",{className:"Screen alert alert-secondary"},!!r&&i.a.createElement("div",{className:"Transaction d-flex justify-content-between bg-white rounded-top border-bottom border-secondary"},i.a.createElement("div",{className:"font-italic"},e(["TRANSACTION~".concat(n),n])),i.a.createElement("div",{className:"font-weight-bold"},le(r))),!a&&i.a.createElement("div",null,c),i.a.createElement(Lt,null),a&&i.a.createElement("div",{className:"text-muted"},a),a&&i.a.createElement("h3",{className:"text-right"},le(a)))},Kt=a(299),Ft=a(654),Bt=a(655),Ut=a(656),zt=a(650),qt=Object(o.forwardRef)((function(e,t){var a=e.action,n=e.height,r=e.color,c=e.keyCodes,l=e.disabled,s=e.onClick,u=e.moreActions,d=e.moreText,m=e.onMoreClick,p=e.children,f=Object(te.a)(e,["action","height","color","keyCodes","disabled","onClick","moreActions","moreText","onMoreClick","children"]),v=Object(kt.a)().t,y=Object(o.useState)(!1),b=Object(ut.a)(y,2),O=b[0],E=b[1],h=Object(o.useCallback)((function(){return E((function(e){return!e}))}),[E]);Object(o.useEffect)((function(){if(!l){var e=function(e){return!c.includes(e.code)||(e.preventDefault(),s(),!1)};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}}),[l,c,s]);var g=Object(o.useMemo)((function(){var e,t=(null===a||void 0===a||null===(e=a.payload)||void 0===e?void 0:e.description)||(null===a||void 0===a?void 0:a.type);return t?v(["ACTION~".concat(t),t]):p}),[a,p,v]),j=Object(o.useMemo)((function(){return[v("Shortcut keys"),c.map((function(e){return v(["KEY_CODE~".concat(e),e])})).join(", ")].join(": ")}),[c,v]);return a&&(null===u||void 0===u?void 0:u.length)?i.a.createElement(Ft.a,{isOpen:O,toggle:h},i.a.createElement(Nt.a,Object.assign({color:"dark",className:"action rounded-left",onClick:s,disabled:l,title:j},f),g||i.a.createElement("span",null,"\xa0")),i.a.createElement(Bt.a,{caret:!0,color:"dark",className:"action",disabled:l}),i.a.createElement(Ut.a,{className:"bg-dark",right:!0},u.map((function(e,t){var a,n;return i.a.createElement(zt.a,{key:t,className:"bg-dark text-light",onClick:function(){return m(e)}},v(["ACTION~".concat((null===(a=e.payload)||void 0===a?void 0:a.description)||e.type),(null===(n=e.payload)||void 0===n?void 0:n.description)||e.type]))})))):(null===u||void 0===u?void 0:u.length)?i.a.createElement("div",{className:"btn-group-vertical d-flex flex-column"},i.a.createElement(Ft.a,{isOpen:O,toggle:h},i.a.createElement(Bt.a,{caret:!0,color:"dark",outline:!0,size:"sm",className:"text-light"},d),i.a.createElement(Ut.a,{right:!0,className:"bg-dark"},u.map((function(e,t){var a,n;return i.a.createElement(zt.a,{key:t,className:"bg-dark text-light",onClick:function(){return m(e)}},v(["ACTION~".concat((null===(a=e.payload)||void 0===a?void 0:a.description)||e.type),(null===(n=e.payload)||void 0===n?void 0:n.description)||e.type]))})))),i.a.createElement(Nt.a,Object.assign({outline:!0,color:"dark",className:Et()("h-100","text-".concat(r||"light")),onClick:s,disabled:l,title:j},f),g||i.a.createElement("span",null,"\xa0"))):i.a.createElement(Nt.a,Object.assign({innerRef:t,style:{height:n},outline:!a,color:"dark",className:Et()("text-".concat(r||"light"),{action:a}),disabled:l,onClick:s,title:j},f),g)})),Wt=function(){var e=Object(kt.a)().t,t=Object(u.b)(),a=Object(u.c)(pt),n=Object(u.c)(mt),r=Object(u.c)(nt),c=Object(o.useState)(!1),l=Object(ut.a)(c,2),s=l[0],d=l[1],m=Object(o.useMemo)((function(){return!n||s}),[n,s]),p=Object(o.useCallback)(function(){var e=Object(ee.a)(Q.a.mark((function e(a){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),a.type!==b&&a.type!==C||setTimeout((function(){return d(!1)}),250),e.next=4,t(Pt[a.type](a));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[t,d]),f=function(e){return Object(ee.a)(Q.a.mark((function t(){return Q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",p(e));case 1:case"end":return t.stop()}}),t)})))};Object(o.useEffect)((function(){a.length&&d(!1)}),[d,a]);var v=Object(o.useRef)(),y=Object(o.useState)(),O=Object(ut.a)(y,2),E=O[0],h=O[1];Object(o.useEffect)((function(){v.current&&h(v.current.offsetWidth)}),[v,h]);var g=Object(Kt.a)(a),j=g[0],N=g[1],k=g.slice(2);return i.a.createElement("div",{className:"Keys"},i.a.createElement("div",{className:"row no-gutters"},i.a.createElement("div",{className:"col-6 p-1"},i.a.createElement(qt,{action:j||{},disabled:!j||s,keyCodes:["F1","NumpadDivide"],onClick:f(j)})),i.a.createElement("div",{className:"col-6 p-1"},i.a.createElement(qt,{action:N||{},disabled:!N||s,keyCodes:["F2","NumpadMultiply"],onClick:f(N),moreActions:k,onMoreClick:function(e){return p(e)}}))),i.a.createElement("div",{className:"row no-gutters"},i.a.createElement("div",{className:"col-3 p-1"},i.a.createElement(qt,{ref:v,height:E,disabled:m,keyCodes:["Numpad7","Digit7"],onClick:function(){return t(Je("7"))}},e("KEY~7"))),i.a.createElement("div",{className:"col-3 p-1"},i.a.createElement(qt,{disabled:m,keyCodes:["Numpad8","Digit8"],onClick:function(){return t(Je("8"))}},e("KEY~8"))),i.a.createElement("div",{className:"col-3 p-1"},i.a.createElement(qt,{disabled:m,keyCodes:["Numpad9","Digit9"],onClick:function(){return t(Je("9"))}},e("KEY~9"))),i.a.createElement("div",{className:"col-3 p-1"},i.a.createElement(qt,{color:"danger",disabled:m,keyCodes:["NumpadSubtract","Escape"],onClick:function(){return t({type:"clearBuffer"})}},e("KEY~X")))),i.a.createElement("div",{className:"row no-gutters"},i.a.createElement("div",{className:"col-3 p-1"},i.a.createElement(qt,{height:E,disabled:m,keyCodes:["Numpad4","Digit4"],onClick:function(){return t(Je("4"))}},e("KEY~4"))),i.a.createElement("div",{className:"col-3 p-1"},i.a.createElement(qt,{disabled:m,keyCodes:["Numpad5","Digit5"],onClick:function(){return t(Je("5"))}},e("KEY~5"))),i.a.createElement("div",{className:"col-3 p-1"},i.a.createElement(qt,{disabled:m,keyCodes:["Numpad6","Digit6"],onClick:function(){return t(Je("6"))}},e("KEY~6"))),i.a.createElement("div",{className:"col-3 p-1"},i.a.createElement(qt,{color:"warning",disabled:m,keyCodes:["NumpadAdd","Backspace","Delete"],onClick:function(){return t({type:"undoBuffer"})}},e("KEY~<")))),i.a.createElement("div",{className:"row no-gutters"},i.a.createElement("div",{className:"col-9"},i.a.createElement("div",{className:"row no-gutters"},i.a.createElement("div",{className:"col-4 p-1"},i.a.createElement(qt,{height:E,disabled:m,keyCodes:["Numpad1","Digit1"],onClick:function(){return t(Je("1"))}},e("KEY~1"))),i.a.createElement("div",{className:"col-4 p-1"},i.a.createElement(qt,{disabled:m,keyCodes:["Numpad2","Digit2"],onClick:function(){return t(Je("2"))}},e("KEY~2"))),i.a.createElement("div",{className:"col-4 p-1"},i.a.createElement(qt,{disabled:m,keyCodes:["Numpad3","Digit3"],onClick:function(){return t(Je("3"))}},e("KEY~3")))),i.a.createElement("div",{className:"row no-gutters"},i.a.createElement("div",{className:"col-8 p-1"},i.a.createElement(qt,{height:E,disabled:m,keyCodes:["Numpad0","Digit0"],onClick:function(){return t(Je("0"))}},e("KEY~0"))),i.a.createElement("div",{className:"col-4 p-1"},i.a.createElement(qt,{disabled:m,keyCodes:["NumpadDecimal","Period"],onClick:function(){return t(Je("00"))}},e("KEY~00"))))),i.a.createElement("div",{className:"col-3 p-1"},i.a.createElement(qt,{color:"success",disabled:m,keyCodes:["NumpadEnter","Enter"],onClick:function(){return t(rt())},moreText:e(["TRANSACTION~".concat(r),r]),moreActions:[{type:C,payload:{description:"TRANSACTION~SALE",mode:I}},{type:C,payload:{description:"TRANSACTION~CREDIT",mode:R}}],onMoreClick:function(e){return p(e)}},e("KEY~O")))))},Ht=function(e){var t=e.mode,a=e.setMode,n=Object(kt.a)().t,r=Object(u.b)(),c=Object(o.useState)(!1),l=Object(ut.a)(c,2),s=l[0],d=l[1],m=Object(o.useCallback)((function(){return d(!s)}),[s,d]),p=Object(o.useCallback)((function(){return r(He())}),[r]),f=Object(o.useCallback)((function(){return r(qe())}),[r]),v=Object(o.useCallback)((function(){return r(Ye())}),[r]);return i.a.createElement(Ft.a,{isOpen:s,toggle:m},i.a.createElement(Bt.a,{size:"sm",outline:!0,color:"dark",className:"text-light",onClick:m,title:n("Menu")},"\u2630"),i.a.createElement(Ut.a,{right:!0},Object.values(Mt).map((function(e){return i.a.createElement(zt.a,{key:e,onClick:function(){return a(e)}},i.a.createElement(Tt,{id:"mode-".concat(e),label:n(["MODE~".concat(e),e]),checked:e===t,readOnly:!0,mb0:!0}))})),i.a.createElement(zt.a,{divider:!0}),i.a.createElement(zt.a,{onClick:p},n("Show Welcome")),i.a.createElement(zt.a,{onClick:f},n("Reset Device")),i.a.createElement(zt.a,{onClick:v},n("Disconnect"))))},Jt=a(651),Gt=a(653),Xt=a(652),Zt=function(e){var t=e.amount,a=e.tipAmount,n=e.payment,r=(t||0)+(a||0),c=((null===n||void 0===n?void 0:n.amount)||0)+((null===n||void 0===n?void 0:n.tipAmount)||0);return{start:r,final:c,partial:r>c,remaining:r-c}},$t=function(e){var t,a,n=e.transaction,r=n||{},c=r.type,o=r.payment,l=Object(kt.a)().t,s=Object(u.b)(),m=Object(d.useToasts)().removeToast,p=Zt(n),f=function(){var e=Object(ee.a)(Q.a.mark((function e(){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s({type:"setBuffer",payload:p.remaining||""});case 3:return e.next=5,s(rt());case 5:e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(0),e.next=11,s(be(e.t0));case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),v=function(){var e=Object(ee.a)(Q.a.mark((function e(){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,m(n.id),e.next=4,s(Ve(n.id));case 4:return e.next=6,s(ct(o));case 6:e.next=12;break;case 8:return e.prev=8,e.t0=e.catch(0),e.next=12,s(be(e.t0));case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return i.a.createElement("div",{className:"Transaction"},n.type!==S&&p.partial&&i.a.createElement("div",{className:"alert alert-warning"},i.a.createElement("h6",{className:"alert-heading"},l("Partial Payment")),i.a.createElement("div",null,l("Remaining"),": ",le(p.remaining))),i.a.createElement("h5",null,l(["TRANSACTION~".concat(c),c])," ",l("Details")),i.a.createElement(Jt.a,{size:"sm",className:"small mb-0"},i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("th",null,l("Payment ID"),":"),i.a.createElement("td",null,o.id)),o.externalPaymentId&&i.a.createElement("tr",null,i.a.createElement("th",null,l("External ID"),":"),i.a.createElement("td",null,o.externalPaymentId)),o.externalReferenceId&&i.a.createElement("tr",null,i.a.createElement("th",null,l("External Ref"),":"),i.a.createElement("td",null,o.externalReferenceId)),i.a.createElement("tr",null,i.a.createElement("th",null,l("Order ID"),":"),i.a.createElement("td",null,(null===(t=o.order)||void 0===t?void 0:t.id)||(null===(a=o.orderRef)||void 0===a?void 0:a.id))),!!o.tipAmount&&i.a.createElement("tr",null,i.a.createElement("th",null,l("Total"),":"),i.a.createElement("td",null,le(o.amount+o.tipAmount))),i.a.createElement("tr",null,i.a.createElement("th",null,l("Amount"),":"),i.a.createElement("td",null,le(o.amount))),!!o.tipAmount&&i.a.createElement("tr",null,i.a.createElement("th",null,l("Tip"),":"),i.a.createElement("td",null,le(o.tipAmount))),i.a.createElement("tr",null,i.a.createElement("th",null,l("Card"),":"),i.a.createElement("td",null,i.a.createElement("div",null,l(["CARD~".concat(o.cardTransaction.cardType),o.cardTransaction.cardType])),i.a.createElement("div",null,function(e){var t=e.first6,a=e.last4;return[t,"*".repeat(6),a].join("").replace(/.{4}/g," $&").trim()}(o.cardTransaction)),o.cardTransaction.cardholderName&&i.a.createElement("div",null,l(["CARDHOLDER_NAME~".concat(o.cardTransaction.cardholderName),o.cardTransaction.cardholderName])))))),n.type===I&&i.a.createElement("div",null,p.partial&&i.a.createElement(Nt.a,{color:"primary",size:"sm",className:"mr-1",onClick:f},l("Process")," ",le(p.remaining)),i.a.createElement(Nt.a,{color:"danger",size:"sm",onClick:v},l("Void"))))},Qt=function(){var e=Object(u.b)(),t=Object(d.useToasts)().addToast;return function(a){var n,r=Zt(a);n=a.type===S?"info":r.final>=r.start?"success":r.final<r.start?"warning":"info",t(i.a.createElement($t,{transaction:a}),{id:a.id,appearance:n,autoDismiss:!1,onDismiss:function(){e(Ve(a.id))}})}},ea=function(){var e=Object(kt.a)().t,t=Object(u.c)(tt),a=Qt(),n=Object(o.useMemo)((function(){return t.sort((function(e,t){return Object(Xt.a)(e.timestamp,t.timestamp)}))}),[t]);return i.a.createElement("div",{className:"History"},i.a.createElement(Jt.a,{size:"sm",hover:!0,className:"table-secondary",striped:!0},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,e("Date")),i.a.createElement("th",null,e("Type")),i.a.createElement("th",{className:"text-right"},e("Amount")))),i.a.createElement("tbody",null,n.map((function(e){return i.a.createElement("tr",{key:e.id,role:"button",onClick:function(){return a(e)}},i.a.createElement("td",null,function(e){var t=e.timestamp;return t?Object(Gt.a)(t,"M/d h:mm a"):"??"}(e)),i.a.createElement("td",null,e.type),i.a.createElement("td",{className:"text-right"},function(e){var t=e.amount,a=e.tipAmount,n=e.payment;return le(n?(n.amount||0)+(n.tipAmount||0):(t||0)+(a||0))}(e)))})))))},ta=(a(640),function(){var e=Object(kt.a)().t,t=Object(u.c)(_t),a=Object(o.useState)(Mt.TRANSACTION),n=Object(ut.a)(a,2),r=n[0],c=n[1];return t?i.a.createElement(ht.a,{className:"Keypad"},i.a.createElement(gt.a,null,i.a.createElement(At,null),i.a.createElement("h3",null,e("Virtual Keypad")),i.a.createElement(Ht,{mode:r,setMode:c})),i.a.createElement(jt.a,null,r===Mt.TRANSACTION&&i.a.createElement(Yt,null),r===Mt.TRANSACTION&&i.a.createElement(Wt,null),r===Mt.HISTORY&&i.a.createElement(ea,null))):null}),aa=function(e){var t=e.error,a=t.message,n=t.stack,r=Object(kt.a)().t,c=Object(o.useState)(!1),l=Object(ut.a)(c,2),s=l[0],u=l[1];return Object(o.useEffect)((function(){return function(){document.querySelectorAll(".Error.expanded").length-(s?1:0)||document.querySelector(".react-toast-notifications__container").classList.remove("expanded")}}),[s]),i.a.createElement("div",{className:Et()("Error",{expanded:s})},i.a.createElement("h5",null,r(["ERROR~".concat(a),a])),!!n&&!s&&i.a.createElement(Nt.a,{color:"link",size:"small",onClick:function(){document.querySelector(".react-toast-notifications__container").classList.add("expanded"),u(!0)}},r("Show details")),!!n&&s&&i.a.createElement("pre",{className:"mb-0"},i.a.createElement("code",null,n)))},na=(a(641),function(){return function(e){var t=Object(u.b)(),a=Object(u.c)(We),n=Object(d.useToasts)().addToast;Object(o.useEffect)((function(){a.message&&n(i.a.createElement(aa,{error:a}),{id:"error",appearance:"error",autoDismiss:e,onDismiss:function(){t({type:"clearError"})}})}),[n,t,a,e])}(function(){var e=Object(o.useState)(!1),t=Object(ut.a)(e,2),a=t[0],n=t[1];return Object(o.useEffect)((function(){if(!a){var e=function(){return n(!0)};return document.addEventListener("mouseover",e),function(){return document.removeEventListener("mouseover",e)}}}),[a,n]),a}()),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.ms,a=void 0===t?500:t;Object(o.useEffect)((function(){var e=0,t=function(t){if(1===t.touches.length){var n=Date.now();1===t.touches.length&&n>e&&(t.preventDefault(),t.target.click()),e=n+a}};return document.body.addEventListener("touchstart",t,{passive:!1}),function(){return document.body.removeEventListener("touchstart",t,{passive:!1})}}),[a])}(),function(){var e=Object(u.c)(at),t=Qt();Object(o.useEffect)((function(){e.forEach(t)}),[e,t])}(),i.a.createElement("div",{className:Et()("App container maxwidth")},i.a.createElement(It,null),i.a.createElement(xt,null),i.a.createElement(ta,null))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(u.a,{store:st},i.a.createElement(d.ToastProvider,{placement:"bottom-center"},i.a.createElement(na,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[305,1,2]]]);
//# sourceMappingURL=main.a23c7d8a.chunk.js.map