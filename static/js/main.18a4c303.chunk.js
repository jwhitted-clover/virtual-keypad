(this["webpackJsonpvirtual-keypad"]=this["webpackJsonpvirtual-keypad"]||[]).push([[0],{299:function(e){e.exports=JSON.parse('{"translation":{"Virtual Keypad":"Virtual Keypad","Clover":"Clover","cloverDomain":{"label":"Clover Domain"},"merchantId":{"label":"Merchant ID","title":"The Merchant ID should be a 13-character alphanumeric value.\\nExample:\xa0ABC1234567890"},"employeeId":{"label":"Employee ID","title":"The Employee ID should be a 13-character alphanumeric value.\\nExample:\xa0ABC1234567890"},"accessToken":{"label":"Access Token","title":"The Access Token should be a 32-character UUID value.\\nExample:\xa012345678-ABCD-1234-ABCD-1234-1234567890AB\\nExample:\xa012345678abcd1234abcd12341234567890ab"},"friendlyId":{"label":"Friendly ID"},"Submit":"Submit","Reset":"Reset","Cancel":"Cancel","Select Devices":"Select Device","cloudPayDisplay":{"installed":"Cloud Pay Display is installed","uninstalled":"Cloud Pay Display is NOT installed"},"Show details":"Show details\u2026","Menu":"Menu","MODE":{"TRANSACTION":"Keypad","HISTORY":"History"},"Show Welcome":"Show Welcome","Reset Device":"Reset Device","Disconnect":"Disconnect","Date":"Date","Type":"Type","Amount":"Amount","ACTION":{"ACCEPT_PAYMENT":"Accept","ACCEPT_SIGNATURE":"Accept","DISCONNECT":"Disconnect","IDENTIFY":"Identify","INVOKE_INPUT_OPTION":"Invoke","REJECT_PAYMENT":"Reject","REJECT_SIGNATURE":"Reject","RESET":"Reset","SHOW_WELCOME":"Show Welcome","TRANSACTION":"Transaction","VOID_PAYMENT":"Void","CANCEL":"Cancel","OK":"OK","Type Card":"Type Card","Enter":"Enter","Clear":"Clear","Done":"Done","No receipt":"No receipt","Print":"Print","Yes":"Yes","No":"No"},"Shortcut keys":"Shortcut keys","KEY_CODE":{"Backspace":"Backspace","Delete":"Delete","Digit0":"Digit 0","Digit1":"Digit 1","Digit2":"Digit 2","Digit3":"Digit 3","Digit4":"Digit 4","Digit5":"Digit 5","Digit6":"Digit 6","Digit7":"Digit 7","Digit8":"Digit 8","Digit9":"Digit 9","Enter":"Enter","Escape":"Esc","F1":"F1","F2":"F2","Numpad0":"Numpad 0","Numpad1":"Numpad 1","Numpad2":"Numpad 2","Numpad3":"Numpad 3","Numpad4":"Numpad 4","Numpad5":"Numpad 5","Numpad6":"Numpad 6","Numpad7":"Numpad 7","Numpad8":"Numpad 8","Numpad9":"Numpad 9","NumpadAdd":"Numpad Add","NumpadDecimal":"Numpad Decimal","NumpadDivide":"Numpad Divide","NumpadEnter":"Numpad Enter","NumpadMultiply":"Numpad Multiply","NumpadSubtract":"Numpad Subtract","Period":"Period"},"KEY":{"0":"0","1":"1","2":"2","3":"3","4":"4","5":"5","6":"6","7":"7","8":"8","9":"9","00":"00","X":"X","<":"<","O":"O"},"TRANSACTION":{"SALE":"Sale","CREDIT":"Credit","VOID":"Void"},"Details":"Details","Partial Payment":"Partial Payment","Remaining":"Remaining","Payment ID":"Payment ID","External ID":"External ID","External Ref":"External Ref","Order ID":"Order ID","Total":"Total","Tip":"Tip","Card":"Card","CARD":{"VISA":"Visa","MC":"Mastercard","AMEX":"AmEx","DISCOVER":"Discover","DINERS_CLUB":"Diner\'s Club","JCB":"JCB","MAESTRO":"Maestro","SOLO":"Solo","LASER":"Laser","CHINA_UNION_PAY":"China Union Pay","CARTE_BLANCHE":"Carte Blanche","UNKNOWN":"Unknown","GIFT_CARD":"Gift Card","EBT":"EBT","GIROCARD":"Girocard","INTERAC":"Interac","OTHER":"Other"},"CARDHOLDER_NAME":{"MANUALLY ENTERED":"(manually entered)"},"Process":"Process","Void":"Void","ERROR":{"Amount is required":"Amount is required","Amount is invalid":"Amount is invalid","Merchant has no devices":"Merchant has no devices","Merchant has no devices with Cloud Pay Display installed":"Merchant has no devices with Cloud Pay Display installed","Device not found":"Device not found","Device does not have Cloud Pay Display installed":"Device does not have Cloud Pay Display installed","No payment was specified":"No payment was specified","Invalid transaction type":"Invalid transaction type"},"STATUS":{"Accepting payment\u2026":"Accepting payment\u2026","Accepting signature\u2026":"Accepting signature\u2026","Rejecting payment\u2026":"Rejecting payment\u2026","Rejecting signature\u2026":"Rejecting signature\u2026","Identifying\u2026":"Identifying\u2026","Connecting\u2026":"Connecting\u2026","Resetting\u2026":"Resetting\u2026","Processing...":"Processing\u2026","Processing\u2026":"Processing\u2026","Verify Signature":"Verify Signature","Customer is tipping\u2026":"Customer is tipping\u2026","Customer is choosing payment method\u2026":"Customer is choosing payment method\u2026","Ready":"Ready","Timed out":"Timed out","Card Number":"Card Number","Customer is signing\u2026":"Customer is signing\u2026","Customer is selecting receipt type\u2026":"Customer is selecting receipt type\u2026","CVV Security Code":"CVV Security Code","Expiration Date":"Expiration Date","Transaction failed: Error connecting to payment gateway. Please try again later":"Transaction failed: Error connecting to payment gateway. Please try again later","This may be a duplicate, do you want to accept this payment?":"This may be a duplicate, do you want to accept this payment?","Partial authorization":"Partial authorization for {{amount}}<br/>Continue with transaction?","Processing card ending":"Processing Card ending in {{last4}}\u2026"},"connected":"connected"}}')},312:function(e,t,n){e.exports=n(656)},654:function(e,t,n){},655:function(e,t,n){},656:function(e,t,n){"use strict";n.r(t);var a,r,c,o,i=n(0),l=n.n(i),s=n(30),u=n.n(s),d=n(8),m=n(45),p=n(48),f=n(296),v=n(95),y=n(20),b="ACCEPT_PAYMENT",O="ACCEPT_SIGNATURE",h="DISCONNECT",E="IDENTIFY",j="INVOKE_INPUT_OPTION",g="REJECT_PAYMENT",C="REJECT_SIGNATURE",N="RESET",k="SHOW_WELCOME",D="TRANSACTION",T="TRANSACTION_MODE",I="CLOUD_PAY_DISPLAY",A=Object(y.a)({},I,"Cloud Pay Display"),w=Object.fromEntries(Object.entries(A).map((function(e){return e.reverse()}))),R="https://www.clover.com",x={MANUAL_ENTRY_ALLOWED:"MANUAL_ENTRY_ALLOWED",PERFORM_MANUAL_REFUND:"PERFORM_MANUAL_REFUND",VOID_PAYMENTS:"VOID_PAYMENTS"},S=/^(Flex|Mini|Mobile)/i,P="SALE",M="CREDIT",_="VOID",L=[],V=n(2),Y=n(156),U=n.n(Y),K=U.a.parse(window.location.search),F=U.a.parse(window.location.hash),B=function(){try{return JSON.parse(atob(localStorage.getItem("clover/virtual-keypad")||"bnVsbA=="))}catch(e){return null}}(),q={cloverDomain:function(){var e,t;if(null===B||void 0===B||null===(e=B.configuration)||void 0===e?void 0:e.cloverDomain)return null===B||void 0===B||null===(t=B.configuration)||void 0===t?void 0:t.cloverDomain;if(document.referrer){var n=new URL(document.referrer);if(n.origin.includes("clover.com"))return n.toString()}return R}(),merchantId:K.merchant_id||(null===B||void 0===B||null===(a=B.configuration)||void 0===a?void 0:a.merchantId)||"",employeeId:K.employee_id||(null===B||void 0===B||null===(r=B.configuration)||void 0===r?void 0:r.employeeId)||"",accessToken:F.access_token||(null===B||void 0===B||null===(c=B.configuration)||void 0===c?void 0:c.accessToken)||"",friendlyId:(null===B||void 0===B||null===(o=B.configuration)||void 0===o?void 0:o.friendlyId)||"Virtual Keypad",loading:void 0},z=n(23),W=n.n(z),H={connector:null,connected:!1},J=function(e){var t=e.device.doTxStart;e.device.doTxStart=function(n,a,r){return"CREDIT"===r&&(n.externalReferenceId=n.externalPaymentId),t.call(e.device,n,a,r)}},G=function(e){try{null===e||void 0===e||e.dispose()}catch(t){}},X={list:[],selected:""},Z={message:null,stack:null},$={employee:null,permissions:null},Q={width:0,height:0,strokes:[]},ee=n(6),te=n.n(ee),ne=n(11),ae=n(37),re=function e(t,n){var a=n.retries,r=void 0===a?3:a,c=Object(ae.a)(n,["retries"]);return fetch(t,c).catch((function(n){if(r>1)return e(t,Object(V.a)({retries:r-1},c));throw n}))},ce=function(e){var t=e.cloverDomain,n=e.merchantId,a=e.deviceId,r=e.accessToken;return re(new URL("/v2/merchant/".concat(n,"/device/").concat(a,"/current_apps?access_token=").concat(r),t).toString(),{method:"GET",headers:{accept:"application/json","content-type":"application/json"}}).then((function(e){return e.json()}))},oe=function(e){var t=e.cloverDomain,n=e.merchantId,a=e.accessToken;return re(new URL("/v3/merchants/".concat(n,"/devices?access_token=").concat(a),t).toString(),{method:"GET",headers:{accept:"application/json","content-type":"application/json"}}).then((function(e){return e.json()}))},ie=function(e){var t=e.cloverDomain,n=e.merchantId,a=e.employeeId,r=e.accessToken;return re(new URL("/v3/merchants/".concat(n,"/employees/").concat(a,"?access_token=").concat(r,"&expand=roles"),t).toString(),{method:"GET",headers:{accept:"application/json","content-type":"application/json"}}).then((function(e){return e.json()}))},le=function(e){var t=e.cloverDomain,n=e.merchantId,a=e.accessToken,r=e.filterNames,c=void 0===r?Object.values(x):r,o=new URL("/v3/merchants/".concat(n,"/permission_sets"),t);return o.searchParams.set("access_token",a),o.searchParams.set("expand","roles"),o.searchParams.set("limit",1e3),(null===c||void 0===c?void 0:c.length)&&o.searchParams.set("filter","name in (".concat(c.map((function(e){return"'".concat(e,"'")})).join(","),")")),re(o.toString(),{method:"GET",headers:{accept:"application/json","content-type":"application/json"}}).then((function(e){return e.json()}))},se=function(e,t){var n=w[t.appName];return n?Object(V.a)(Object(V.a)({},e),{},Object(y.a)({},n,!0)):e},ue=function(e,t){return e.reduce((function(e,n){var a=e[e.length-1];return a.length===t?e.push([n]):a.push(n),e}),[[]])},de=function(){var e=Object(ne.a)(te.a.mark((function e(t){var n,a,r,c,o,i,l,s,u;return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.cloverDomain,a=t.merchantId,r=t.accessToken,e.next=3,oe({cloverDomain:n,merchantId:a,accessToken:r});case 3:c=e.sent,o=c.elements,i=o.filter((function(e){return S.test(e.productName)})),l=ue(i,4),s=0;case 8:if(!(s<l.length)){e.next=15;break}return e.next=11,Promise.all(l[s].map((function(e){var t=e.id;return ce({cloverDomain:n,merchantId:a,accessToken:r,deviceId:t})})));case 11:l[s]=e.sent;case 12:s++,e.next=8;break;case 15:return u=l.flat(),e.abrupt("return",i.map((function(e,t){return Object(V.a)(Object(V.a)({},e),{},{apps:u[t].applications.reduce(se,{})})})));case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),me=n(16),pe=function(){var e=Object(ne.a)(te.a.mark((function e(t){var n,a,r,c,o,i,l,s;return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.cloverDomain,a=t.merchantId,r=t.accessToken,c=t.employeeId,e.next=3,Promise.all([ie({cloverDomain:n,merchantId:a,employeeId:c,accessToken:r}).catch((function(){return null})),le({cloverDomain:n,merchantId:a,accessToken:r}).catch((function(){return null}))]);case 3:return o=e.sent,i=Object(me.a)(o,2),l=i[0],s=i[1],e.abrupt("return",{employee:l,permissions:s});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fe=function(e){var t=+e;return!isNaN(t)&&t>=0?(t/100).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):""},ve={active:null,mode:P,data:{}},ye=Object(p.c)({actions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case"clearActions":return L;case"appendActions":var r=e.some((function(e){var t,n;return e.type===a.type&&(null===(t=e.payload)||void 0===t?void 0:t.description)===(null===(n=a.payload)||void 0===n?void 0:n.description)}));return r?e:[].concat(Object(v.a)(e),[a]);case"setActions":return a||[];case"setConnector":return[{type:h,payload:{description:"Cancel"}}];case"@@connector/onDeviceReady":case"@@connector/onResetDeviceResponse":return[{type:E},{type:D}];case"@@connector/onDeviceActivityStart":return a.inputOptions.map((function(e){return{type:j,payload:e}}));case"@@connector/onSaleResponse":case"@@connector/onVoidPaymentResponse":case"@@connector/onManualRefundResponse":return[{type:E},{type:D}];case"@@connector/onConfirmPaymentRequest":return[{type:b,payload:a},{type:g,payload:a}];case"@@connector/onVerifySignatureRequest":return[{type:O,payload:a},{type:C,payload:a}];default:return e}},buffer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case"clearBuffer":return"";case"appendBuffer":return(e+a).replace(/^0+/,"").slice(0,7);case"setBuffer":return a;case"undoBuffer":return e.length?e.slice(0,e.length-1):"";default:return e}},configuration:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case"setConfigurationLoading":return Object(V.a)(Object(V.a)({},e),{},{loading:!0});case"setConfigurationNotLoading":return Object(V.a)(Object(V.a)({},e),{},{loading:void 0});case"setConfiguration":return Object(V.a)(Object(V.a)({},e),{},{cloverDomain:a.cloverDomain||"",merchantId:a.merchantId||"",employeeId:a.employeeId||"",accessToken:a.accessToken||"",friendlyId:a.friendlyId||""});default:return e}},connection:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case"clearConnector":return G(e.connector),H;case"setConnector":return G(e.connector),Object(V.a)(Object(V.a)({},e),{},{connector:a,connected:!1});case"@@connector/onDeviceDisconnected":return Object(V.a)(Object(V.a)({},e),{},{connected:!1});case"@@connector/onDeviceReady":J(e.connector);var r=new W.a.remotepay.RetrieveDeviceStatusRequest;return r.setSendLastMessage(!0),e.connector.retrieveDeviceStatus(r),Object(V.a)(Object(V.a)({},e),{},{connected:!0});default:return e}},devices:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case"clearDevices":return Object(V.a)(Object(V.a)({},e),{},{list:[]});case"clearDeviceId":return Object(V.a)(Object(V.a)({},e),{},{selected:""});case"setDeviceId":return Object(V.a)(Object(V.a)({},e),{},{selected:a||""});case"setDevices":return Object(V.a)(Object(V.a)({},e),{},{list:a||[]});default:return e}},error:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case"clearError":return Z;case"setError":return Object(V.a)(Object(V.a)({},e),{},{message:a.message,stack:a.stack});case"@@connector/onDeviceError":return Object(V.a)(Object(V.a)({},e),{},{message:"Device Error ".concat(a.message),stack:JSON.stringify(a,null,2)});case"@@connector/onManualRefundResponse":case"@@connector/onSaleResponse":case"@@connector/onVoidPaymentResponse":return a.success?e:Object(V.a)(Object(V.a)({},e),{},{message:a.message,stack:JSON.stringify(a,null,2)});default:return e}},settings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case"setEmployee":return Object(V.a)(Object(V.a)({},e),{},{employee:a});case"setPermissions":return Object(V.a)(Object(V.a)({},e),{},{permissions:a});default:return e}},signature:function(){var e,t,n,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,r=arguments.length>1?arguments[1]:void 0,c=r.type,o=r.payload;switch(c){case"clearSignature":return Q;case"setSignature":return{width:(null===o||void 0===o?void 0:o.width)||0,height:(null===o||void 0===o?void 0:o.height)||0,strokes:(null===o||void 0===o?void 0:o.strokes)||[]};case"@@connector/onVerifySignatureRequest":return{width:(null===(e=o.signature)||void 0===e?void 0:e.width)||0,height:(null===(t=o.signature)||void 0===t?void 0:t.height)||0,strokes:(null===(n=o.signature)||void 0===n?void 0:n.strokes)||[]};default:return a}},status:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case"clearStatus":return"";case"setStatus":return a||"";case"@@connector/onDeviceReady":case"@@connector/onResetDeviceResponse":return"Ready";case"@@connector/onDeviceActivityStart":return a.message;case"@@connector/onSaleResponse":case"@@connector/onVoidPaymentResponse":case"@@connector/onManualRefundResponse":return"Ready";case"@@connector/onConfirmPaymentRequest":return a.challenges[0].message;case"@@connector/onVerifySignatureRequest":return"Verify Signature";default:return e}},transactions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case"setTransactionMode":return Object(V.a)(Object(V.a)({},e),{},{mode:a});case"setActiveTransaction":if(a.id){var r=e.data[a.id]||{};return Object(V.a)(Object(V.a)({},e),{},{active:a.id,data:Object(V.a)(Object(V.a)({},e.data),{},Object(y.a)({},a.id,Object(V.a)(Object(V.a)({},e.data[a.id]),{},{id:a.id,timestamp:Date.now(),type:a.type||r.type,amount:a.amount||r.amount||0,tipAmount:a.tipAmount||r.tipAmount||0})))})}return Object(V.a)(Object(V.a)({},e),{},{active:""});case"hideTransaction":return Object(V.a)(Object(V.a)({},e),{},{data:Object(V.a)(Object(V.a)({},e.data),{},Object(y.a)({},a,Object(V.a)(Object(V.a)({},e.data[a]),{},{visible:!1})))});case"showTransaction":return Object(V.a)(Object(V.a)({},e),{},{data:Object(V.a)(Object(V.a)({},e.data),{},Object(y.a)({},a,Object(V.a)(Object(V.a)({},e.data[a]),{},{visible:!0})))});case"removeTransaction":var c=Object(V.a)(Object(V.a)({},e),{},{data:Object(V.a)({},e.data)});return delete c.data[a],c;case"updateTransaction":var o=e.data[a.id]||{};return Object(V.a)(Object(V.a)({},e),{},{data:Object(V.a)(Object(V.a)({},e.data),{},Object(y.a)({},a.id,Object(V.a)(Object(V.a)({},o),{},{id:a.id,timestamp:Date.now(),visible:a.visible||o.visible||!1,amount:a.amount||o.amount||0,tipAmount:a.tipAmount||o.tipAmount||0,type:a.type||o.type||"",payment:a.payment||o.payment||null})))});case"@@connector/onSaleResponse":return a.success?Object(V.a)(Object(V.a)({},e),{},{active:"",data:Object(V.a)(Object(V.a)({},e.data),{},Object(y.a)({},a.payment.externalPaymentId,Object(V.a)(Object(V.a)({},e.data[a.payment.externalPaymentId]),{},{id:a.payment.externalPaymentId,timestamp:Date.now(),visible:!0,type:P,payment:a.payment})))}):e;case"@@connector/onManualRefundResponse":return a.success?Object(V.a)(Object(V.a)({},e),{},{active:"",data:Object(V.a)(Object(V.a)({},e.data),{},Object(y.a)({},a.credit.externalReferenceId,Object(V.a)(Object(V.a)({},e.data[a.credit.externalReferenceId]),{},{id:a.credit.externalReferenceId,timestamp:Date.now(),visible:!0,type:M,payment:a.credit})))}):e;case"@@connector/onVoidPaymentResponse":return a.success?Object(V.a)(Object(V.a)({},e),{},{active:"",data:Object(V.a)(Object(V.a)({},e.data),{},Object(y.a)({},a.payment.externalPaymentId,Object(V.a)(Object(V.a)({},e.data[a.payment.externalPaymentId]),{},{id:a.payment.externalPaymentId,timestamp:Date.now(),visible:!0,type:_,payment:a.payment})))}):e;default:return e}}}),be=n(14),Oe=function(e){return e.configuration},he=Object(be.a)(Oe,(function(e){return e.friendlyId||"Virtual Keypad"})),Ee=Object(be.a)(Oe,(function(e){return e.cloverDomain===R})),je=Object(be.a)(Ee,(function(e){return e?W.a.CardEntryMethods.DEFAULT:W.a.CardEntryMethods.DEFAULT|W.a.CardEntryMethods.CARD_ENTRY_METHOD_MANUAL})),ge=Object(be.a)(Oe,(function(e){return e.loading||!1})),Ce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.message,n=e.stack;return{type:"setError",payload:{message:t,stack:n}}},Ne=function(e){return{type:"setActions",payload:e}},ke=function(e){return e.connection},De=Object(be.a)(ke,(function(e){return e.connector})),Te=(Object(be.a)(ke,(function(e){return e.connected})),function(e){return{type:"setStatus",payload:e}}),Ie=function(e){var t,n=e.configuration,a=e.devices;return t={configuration:Object(V.a)(Object(V.a)({},n),{},{loading:void 0}),devices:Object(V.a)(Object(V.a)({},X),{},{selected:a.selected})},void localStorage.setItem("clover/virtual-keypad",btoa(JSON.stringify(t)))},Ae=function(e){return{type:"setConfiguration",payload:{cloverDomain:e.cloverDomain,merchantId:e.merchantId,employeeId:e.employeeId,accessToken:e.accessToken,friendlyId:e.friendlyId}}},we=function(e){return{type:"setDeviceId",payload:e}},Re=function(e){return{type:"setDevices",payload:e}},xe=function(e){return{type:"setPermissions",payload:e}},Se=function(e){var t=e.cloverDomain,n=e.merchantId,a=e.employeeId,r=e.accessToken,c=e.friendlyId;return function(){var e=Object(ne.a)(te.a.mark((function e(o,i){var l,s,u,d;return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o({type:"configure",payload:{cloverDomain:t,merchantId:n,employeeId:a,accessToken:r,friendlyId:c}});case 3:return e.next=5,o({type:"clearError"});case 5:return e.next=7,o({type:"setConfigurationLoading"});case 7:return e.next=9,o(Ae({cloverDomain:t,merchantId:n,employeeId:a,accessToken:r,friendlyId:c}));case 9:return Ie(i()),e.next=12,de({cloverDomain:t,merchantId:n,employeeId:a,accessToken:r});case 12:return l=e.sent,e.next=15,o(Re(l));case 15:if(l.length){e.next=17;break}throw new Error("Merchant has no devices");case 17:if(l.some((function(e){return e.apps[I]}))){e.next=19;break}throw new Error("Merchant has no devices with Cloud Pay Display installed");case 19:return e.next=21,pe({cloverDomain:t,merchantId:n,employeeId:a,accessToken:r});case 21:return s=e.sent,u=s.employee,d=s.permissions,e.next=26,o({type:"setEmployee",payload:u});case 26:return e.next=28,o(xe(d));case 28:e.next=34;break;case 30:return e.prev=30,e.t0=e.catch(0),e.next=34,o(Ce(e.t0));case 34:return e.prev=34,e.next=37,o({type:"setConfigurationNotLoading"});case 37:return e.finish(34);case 38:case"end":return e.stop()}}),e,null,[[0,30,34,38]])})));return function(t,n){return e.apply(this,arguments)}}()},Pe=n(297),Me=n(93),_e=n(309),Le=n(308),Ve=function(e){return e.devices},Ye=Object(be.a)(Ve,(function(e){return e.selected})),Ue=Object(be.a)(Ve,Ye,(function(e,t){var n=e.list;return Object(v.a)(n).sort((function(e,n){return e.id===t?-1:n.id===t?1:0}))})),Ke=function(e){return{type:"setConnector",payload:e}},Fe=function(e){return function(){var t=Object(ne.a)(te.a.mark((function t(n,a){var r,c,o,i,l,s,u,d,m,p,f;return te.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n({type:"connect",payload:e});case 3:return t.next=5,n(we(e));case 5:if(r=a(),Ie(r),c=Oe(r),o=c.cloverDomain,i=c.merchantId,l=c.accessToken,s=c.friendlyId,u=Ue(r).find((function(t){return t.id===e}))){t.next=11;break}throw new Error("Device not found");case 11:if(u.apps[I]){t.next=13;break}throw new Error("Device does not have Cloud Pay Display installed");case 13:d=W.a.CloverConnectorFactoryBuilder.createICloverConnectorFactory(Object(y.a)({},W.a.CloverConnectorFactoryBuilder.FACTORY_VERSION,W.a.CloverConnectorFactoryBuilder.VERSION_12)),m=d.createICloverConnector(new W.a.WebSocketCloudCloverDeviceConfigurationBuilder("virtual-keypad",e,i,l).setCloverServer(o).setFriendlyId(s).build()),p=function(e){Object(_e.a)(a,e);var t=Object(Le.a)(a);function a(){var e;return Object(Pe.a)(this,a),e=t.call(this),Object.keys(Object.getPrototypeOf(Object.getPrototypeOf(Object(Me.a)(e)))).forEach((function(t){e[t]=function(e){return n({type:"@@connector/".concat(t),payload:e})}})),e}return a}(W.a.remotepay.ICloverConnectorListener),f=new p,m.addCloverConnectorListener(f),n(Ke(m)),n(Te("Connecting\u2026")),m.initializeConnection(),t.next=26;break;case 23:t.prev=23,t.t0=t.catch(0),n(Ce(t.t0));case 26:case"end":return t.stop()}}),t,null,[[0,23]])})));return function(e,n){return t.apply(this,arguments)}}()},Be=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,n=e.type,a=e.amount,r=e.tipAmount;return{type:"setActiveTransaction",payload:{id:t,type:n,amount:a,tipAmount:r}}},qe=function(e){return{type:"hideTransaction",payload:e}},ze=function(e){return{type:"updateTransaction",payload:{id:e.id,type:e.type,amount:e.amount,tipAmount:e.tipAmount,payment:e.payment}}},We=function(){return function(){var e=Object(ne.a)(te.a.mark((function e(t,n){var a;return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t({type:"disconnect"});case 3:return a=De(n()),e.prev=4,a.showWelcomeScreen(),e.next=8,new Promise((function(e){return setTimeout(e,500)}));case 8:e.next=12;break;case 10:e.prev=10,e.t0=e.catch(4);case 12:return a.dispose(),e.next=15,t({type:"clearConnector"});case 15:return e.next=17,t({type:"clearDevices"});case 17:return e.next=19,t(Be());case 19:e.next=25;break;case 21:return e.prev=21,e.t1=e.catch(0),e.next=25,t(Ce(e.t1));case 25:case"end":return e.stop()}}),e,null,[[0,21],[4,10]])})));return function(t,n){return e.apply(this,arguments)}}()},He=n(307),Je=n(38),Ge=n(298),Xe={en:n(299)},Ze=He.a.use(Ge.a).use(Je.e).init({fallbackLng:"en",debug:!1,keySeparator:"~",nsSeparator:!1,interpolation:{escapeValue:!1},resources:Xe}),$e=function(e){return function(){var t=Object(ne.a)(te.a.mark((function t(n,a){return te.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{n(Object(V.a)(Object(V.a)({},e),{},{type:"reset"})),n(Te("Resetting\u2026")),n({type:"clearActions"}),De(a()).resetDevice()}catch(r){n(Ce(r))}case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},Qe=function(e){return e.error},et=function(e){return function(){var t=Object(ne.a)(te.a.mark((function t(n,a){return te.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{n(Object(V.a)(Object(V.a)({},e),{},{type:"showWelcome"})),n(Te("Ready")),n(Ne([{type:E},{type:D}])),De(a()).showWelcomeScreen()}catch(r){n(Ce(r))}case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},tt=function(e){return{type:"appendBuffer",payload:e}},nt=function(e){return e.buffer},at=function(e){return e.transactions},rt=Object(be.a)(at,(function(e){var t=e.data;return Object.values(t)})),ct=Object(be.a)(at,(function(e){var t=e.active;return e.data[t]})),ot=Object(be.a)(ct,(function(e){return null===e||void 0===e?void 0:e.type})),it=Object(be.a)(ct,(function(e){return((null===e||void 0===e?void 0:e.amount)||0)+((null===e||void 0===e?void 0:e.tipAmount)||0)})),lt=Object(be.a)(rt,(function(e){return e.filter((function(e){return e.payment}))})),st=Object(be.a)(lt,(function(e){return e.filter((function(e){return e.visible}))})),ut=Object(be.a)(at,(function(e){return e.mode})),dt=function(e){return function(){var t=Object(ne.a)(te.a.mark((function t(n,a){var r,c,o,i,l,s,u,d,m,p;return te.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Ze;case 3:if(r=t.sent,n(Object(V.a)(Object(V.a)({},e),{},{type:"transaction"})),c=a(),o=nt(c),i=De(c),l=je(c),s=ut(c),n({type:"clearActions"}),n(Te("Processing...")),n({type:"clearBuffer"}),u=+o){t.next=16;break}throw new Error("Amount is required");case 16:if(!isNaN(u)){t.next=18;break}throw new Error("Amount is invalid");case 18:if(!(u<=0||u>9999999)){t.next=20;break}throw new Error("Amount is invalid");case 20:d=W.a.CloverID.getNewId(),s===M&&(d=d.slice(0,12)),n(Be({id:d,type:s,amount:u})),t.t0=s,t.next=t.t0===P?26:t.t0===M?33:40;break;case 26:return(m=new W.a.remotepay.SaleRequest).setAmount(u),m.setExternalId(d),m.setCardEntryMethods(l),n(ze({id:d,type:P,amount:u})),i.sale(m),t.abrupt("break",41);case 33:return(p=new W.a.remotepay.ManualRefundRequest).setAmount(u),p.setExternalId(d),p.setCardEntryMethods(l),n(ze({id:d,type:M,amount:u})),i.manualRefund(p),t.abrupt("break",41);case 40:throw new Error("".concat(r("ERROR~Invalid transaction type"),": ").concat(s));case 41:t.next=47;break;case 43:t.prev=43,t.t1=t.catch(0),n(Ce(t.t1)),n({type:"@@connector/onDeviceReady"});case 47:case"end":return t.stop()}}),t,null,[[0,43]])})));return function(e,n){return t.apply(this,arguments)}}()},mt=function(e){return function(){var t=Object(ne.a)(te.a.mark((function t(n,a){var r,c,o,i,l,s,u;return te.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n({type:"voidPayment",payload:e}),r=e.id,c=e.externalPaymentId,o=e.orderId,i=e.amount,l=e.tipAmount,s=De(a()),n({type:"clearActions"}),n(Te("Processing\u2026")),r){t.next=8;break}throw new Error("No payment was specified");case 8:n(Be({id:c,type:_,amount:i,tipAmount:l})),(u=new W.a.remotepay.VoidPaymentRequest).setPaymentId(r),u.setOrderId(o),u.setVoidReason(W.a.order.VoidReason.USER_CANCEL),s.voidPayment(u),t.next=21;break;case 17:t.prev=17,t.t0=t.catch(0),n(Ce(t.t0)),n({type:"@@connector/onDeviceReady"});case 21:case"end":return t.stop()}}),t,null,[[0,17]])})));return function(e,n){return t.apply(this,arguments)}}()},pt=function(e){var t=Object(p.a)(f.a),n=window.__REDUX_DEVTOOLS_EXTENSION__,a=n?n():function(e){return e};return Object(p.e)(ye,e,Object(p.d)(t,a))}(void 0),ft=Oe(pt.getState());pt.dispatch(Se(ft));var vt,yt=pt,bt=function(e){return e.actions},Ot=Object(be.a)(bt,(function(e){return e.find((function(e){return e.type===D}))})),ht=Object(be.a)(bt,(function(e){var t=e.filter((function(e){return e.type!==D}));if(2===t.length){var n,a,r=Object(me.a)(t,2),c=r[0],o=r[1];if("No"===(null===(n=c.payload)||void 0===n?void 0:n.description)&&"Yes"===(null===(a=o.payload)||void 0===a?void 0:a.description))return[o,c]}return t})),Et=function(e){return e.settings},jt=Object(be.a)(Et,(function(e){return e.employee})),gt=Object(be.a)(jt,(function(e){var t;return null===e||void 0===e||null===(t=e.roles)||void 0===t?void 0:t.elements})),Ct=Object(be.a)(Et,(function(e){var t=e.permissions;return null===t||void 0===t?void 0:t.elements})),Nt=Object(be.a)(gt,Ct,(function(e,t){if(e&&t){var n=e.map((function(e){return e.id})),a=new Set(t.filter((function(e){return e.name===x.PERFORM_MANUAL_REFUND})).map((function(e){var t;return null===(t=e.roles)||void 0===t?void 0:t.elements.map((function(e){return e.id}))})).flat());return n.some((function(e){return a.has(e)}))}return!1})),kt=Object(be.a)(gt,Ct,(function(e,t){if(e&&t){var n=e.map((function(e){return e.id})),a=new Set(t.filter((function(e){return e.name===x.VOID_PAYMENTS})).map((function(e){var t;return null===(t=e.roles)||void 0===t?void 0:t.elements.map((function(e){return e.id}))})).flat());return n.some((function(e){return a.has(e)}))}return!1})),Dt=function(e){return e.signature},Tt=Object(be.a)(Dt,(function(e){var t=e.strokes.map((function(e){return e.points})).flat().reduce((function(e,t){var n=e.x,a=e.X,r=e.y,c=e.Y;return{x:Math.min(n,t.x),X:Math.max(a,t.x),y:Math.min(r,t.y),Y:Math.max(c,t.y)}}),{x:1/0,X:-1/0,y:1/0,Y:-1/0});return[t.x,t.y,t.X-t.x,t.Y-t.y].join(" ")})),It=Object(be.a)(Dt,(function(e){return e.strokes.map((function(e){return e.points.map((function(e){var t=e.x,n=e.y;return"".concat(t,",").concat(n)})).join(" ")}))})),At=function(e){return e.status},wt=n(10),Rt=n.n(wt),xt=n(659),St=n(660),Pt=n(661),Mt=n(662),_t=n(303),Lt=n(658),Vt=Object(be.a)(De,Ue,(function(e,t){return!e&&!t.length})),Yt=function(e){var t=e.id,n=e.type,a=void 0===n?"text":n,r=e.autoCorrect,c=void 0===r?"off":r,o=e.autoComplete,i=void 0===o?"off":o,s=e.autoCapitalize,u=void 0===s?"off":s,d=e.spellCheck,m=void 0===d?"false":d,p=e.value,f=e.disabled,v=e.onChange,y=Object(ae.a)(e,["id","type","autoCorrect","autoComplete","autoCapitalize","spellCheck","value","disabled","onChange"]),b=Object(Lt.a)().t;return l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{htmlFor:t},b("".concat(t,"~label")),":"),l.a.createElement("input",Object.assign({id:t,type:a,className:"form-control",title:b("".concat(t,"~title"),""),autoCorrect:c,autoComplete:i,autoCapitalize:u,spellCheck:m,value:p,onChange:function(e){return v(e.target.value)},disabled:f},y)))},Ut=function(e){var t=e.id,n=e.label,a=e.checked,r=e.onChange,c=e.disabled,o=e.switch,i=e.mb0,s=Object(ae.a)(e,["id","label","checked","onChange","disabled","switch","mb0"]);return l.a.createElement("div",{className:Rt()("form-group",{"mb-0":i})},l.a.createElement("div",{className:Rt()("custom-control",{"custom-switch":o,"custom-checkbox":!o})},l.a.createElement("input",Object.assign({id:t,type:"checkbox",className:"custom-control-input",checked:a,onChange:function(){return r(!a)},disabled:c},s)),l.a.createElement("label",{className:"custom-control-label font-weight-normal",htmlFor:t},n)))},Kt=function(e){var t=e.size,n=void 0===t?28:t,a=Object(Lt.a)().t;return l.a.createElement("svg",{className:"Logo",id:"clover-logo-svg",xmlns:"http://www.w3.org/2000/svg",width:n,height:n,viewBox:"0 0 33.15 33.15","aria-labelledby":"svg-logo-title",role:"image"},l.a.createElement("title",{id:"svg-logo-title"},a("Clover")),l.a.createElement("g",{id:"clover-symbol-2","data-name":"clover-symbol"},l.a.createElement("path",{d:"M191.45,85.64A7.5,7.5,0,1,0,184,93.09h7.49V85.64Z",transform:"translate(-176.46 -77.01)"}),l.a.createElement("path",{d:"M193.61,85.64a7.5,7.5,0,1,1,7.49,7.45h-7.49V85.64Z",transform:"translate(-176.46 -77.01)"}),l.a.createElement("path",{d:"M193.61,102.7a7.5,7.5,0,1,0,7.49-7.45h-7.49v7.45Z",transform:"translate(-176.46 -77.01)"}),l.a.createElement("path",{d:"M191.46,102.7A7.5,7.5,0,1,1,184,95.25h7.49v7.45Zm-7.5,5.35a5.38,5.38,0,0,0,5.4-5.35V97.36H184a5.35,5.35,0,1,0,0,10.7h0Z",transform:"translate(-176.46 -77.01)"})))},Ft=function(){var e=Object(Lt.a)().t,t=Object(d.b)(),n=Object(d.c)(Oe),a=Object(d.c)(ge),r=Object(d.c)(Vt),c=Object(i.useState)(n.cloverDomain),o=Object(me.a)(c,2),s=o[0],u=o[1],m=Object(i.useState)(n.merchantId),p=Object(me.a)(m,2),f=p[0],v=p[1],y=Object(i.useState)(n.employeeId),b=Object(me.a)(y,2),O=b[0],h=b[1],E=Object(i.useState)(n.accessToken),j=Object(me.a)(E,2),g=j[0],C=j[1],N=Object(i.useState)(n.friendlyId),k=Object(me.a)(N,2),D=k[0],T=k[1],I=Object(i.useState)(!1),A=Object(me.a)(I,2),w=A[0],R=A[1],x=Object(i.useMemo)((function(){return a||w}),[a,w]),S=Object(i.useCallback)(function(){var e=Object(ne.a)(te.a.mark((function e(n){return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n.preventDefault(),R(!0),e.next=5,t(Se({cloverDomain:s,merchantId:f,employeeId:O,accessToken:g,friendlyId:D}));case 5:return e.prev=5,R(!1),e.finish(5);case 8:case"end":return e.stop()}}),e,null,[[0,,5,8]])})));return function(t){return e.apply(this,arguments)}}(),[t,s,f,O,g,D]),P=Object(i.useCallback)((function(e){e.preventDefault(),u(n.cloverDomain),v(n.merchantId),h(n.employeeId),C(n.accessToken),T(n.friendlyId)}),[n,u,v,h,C,T]);return r?l.a.createElement("form",{onSubmit:S,onReset:P},l.a.createElement(xt.a,{className:"Configuration"},l.a.createElement(St.a,null,l.a.createElement(Kt,null),l.a.createElement("h3",null,e("Virtual Keypad"))),a&&l.a.createElement(Pt.a,null,l.a.createElement("p",null,"Loading...")),!a&&l.a.createElement(l.a.Fragment,null,l.a.createElement(Pt.a,null,l.a.createElement(Yt,{id:"cloverDomain",type:"url",value:s,onChange:u,disabled:x,required:!0}),l.a.createElement(Yt,{id:"merchantId",pattern:"^[a-zA-Z0-9]{13}$",maxLength:"13",value:f,onChange:v,disabled:x,required:!0}),l.a.createElement(Yt,{id:"employeeId",pattern:"^[a-zA-Z0-9]{13}$",maxLength:"13",value:O,onChange:h,disabled:x}),l.a.createElement(Yt,{id:"accessToken",pattern:"^[a-fA-F0-9]{8}(-?[a-fA-F0-9]{4}){3}-?[a-fA-F0-9]{12}$",value:g,onChange:C,disabled:x,required:!0}),l.a.createElement(Yt,{id:"friendlyId",value:D,onChange:T,disabled:x})),l.a.createElement(Mt.a,null,l.a.createElement(_t.a,{type:"submit",color:"success",disabled:x},e("Submit")),l.a.createElement(_t.a,{type:"reset",color:"secondary",className:"ml-2",disabled:x},e("Reset")))))):null},Bt=Object(be.a)(De,Ue,(function(e,t){return!e&&!!t.length})),qt=n(669),zt=function(e){var t=e.device,n=e.active,a=e.disabled,r=e.onClick,c=Object(Lt.a)().t,o=Object(i.useState)(!1),s=Object(me.a)(o,2),u=s[0],d=s[1],m=Object(i.useMemo)((function(){return"device-".concat(t.id)}),[t.id]),p=function(e){e&&(e.preventDefault(),e.stopPropagation()),d(!u)},f=t.apps[I],v=c("cloudPayDisplay~".concat(f?"":"un","installed"));return l.a.createElement("button",{key:t.id,type:"button",className:Rt()("list-group-item d-flex justify-content-between align-items-center list-group-item-action p-1",{disabled:a,"list-group-item-primary":!a&&n}),onClick:r},l.a.createElement("div",{className:"p-1"},t.name&&l.a.createElement("div",{className:"font-weight-bold"},t.name),t.productName," ",t.serial),l.a.createElement("span",{id:m,onMouseEnter:function(){return d(!0)},onMouseLeave:function(){return d(!1)},onClick:p,className:Rt()("badge p-1",{"badge-secondary":a,"badge-success":!a&&f,"badge-warning":!a&&!f}),role:"img","aria-label":v},"\u2601\ufe0f"),l.a.createElement(qt.a,{isOpen:u,target:m,toggle:p,placement:"left"},l.a.createElement("span",{className:"small"},v)))},Wt=function(){var e=Object(Lt.a)().t,t=Object(d.b)(),n=Object(d.c)(Ue),a=Object(d.c)(Ye),r=Object(d.c)(Bt),c=Object(i.useState)(),o=Object(me.a)(c,2),s=o[0],u=o[1],m=Object(i.useCallback)((function(e){return function(){var n=Object(ne.a)(te.a.mark((function n(a){return te.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,a.preventDefault(),u(!0),n.next=5,t(Fe(e));case 5:return n.prev=5,u(!1),n.finish(5);case 8:case"end":return n.stop()}}),n,null,[[0,,5,8]])})));return function(e){return n.apply(this,arguments)}}()}),[t]);return r?l.a.createElement(xt.a,{className:"Devices"},l.a.createElement(St.a,null,l.a.createElement(Kt,null),l.a.createElement("h3",null,e("Virtual Keypad")),l.a.createElement("button",{className:"close text-light",title:e("Cancel"),onClick:function(){return t({type:"clearDevices"})},disabled:s},"\xd7")),l.a.createElement(Pt.a,null,l.a.createElement("div",{className:"form-group"},l.a.createElement("label",null,e("Select Device"),":"),l.a.createElement("div",{className:"list-group"},n.map((function(e){return l.a.createElement(zt,{key:e.id,device:e,disabled:s,active:e.id===a,onClick:m(e.id)})})))))):null},Ht=(vt={},Object(y.a)(vt,b,(function(e){return function(){var t=Object(ne.a)(te.a.mark((function t(n,a){return te.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{n(Object(V.a)(Object(V.a)({},e),{},{type:"acceptPayment"})),n(Te("Accepting payment\u2026")),n({type:"clearActions"}),De(a()).acceptPayment(e.payload.payment)}catch(r){n(Ce(r))}case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()})),Object(y.a)(vt,O,(function(e){return function(){var t=Object(ne.a)(te.a.mark((function t(n,a){var r,c;return te.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{n(Object(V.a)(Object(V.a)({},e),{},{type:"acceptSignature"})),n(Te("Accepting signature\u2026")),n({type:"clearActions"}),n({type:"clearSignature"}),r=De(a()),(c=new W.a.remotepay.VerifySignatureRequest).setPayment(e.payload.payment),r.acceptSignature(c)}catch(o){n(Ce(o))}case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()})),Object(y.a)(vt,h,We),Object(y.a)(vt,E,(function(e){return function(){var t=Object(ne.a)(te.a.mark((function t(n,a){var r,c,o,i;return te.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Ze;case 3:r=t.sent,n(Object(V.a)(Object(V.a)({},e),{},{type:"identify"})),n(Te("Identifying\u2026")),n(Ne([{type:k,payload:{description:"OK"}},{type:h,payload:{description:"Cancel"}}])),c=a(),o=De(c),i=he(c),o.showMessage("".concat(i," ").concat(r("connected"))),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),n(Ce(t.t0));case 16:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(e,n){return t.apply(this,arguments)}}()})),Object(y.a)(vt,j,(function(e){return function(){var t=Object(ne.a)(te.a.mark((function t(n,a){var r,c;return te.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{n(Object(V.a)(Object(V.a)({},e),{},{type:"invokeInputOption"})),r=De(a()),(c=new W.a.remotepay.InputOption).setDescription(e.payload.description),c.setKeyPress(e.payload.keyPress),r.invokeInputOption(c)}catch(o){n(Ce(o))}case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()})),Object(y.a)(vt,g,(function(e){return function(){var t=Object(ne.a)(te.a.mark((function t(n,a){return te.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{n(Object(V.a)(Object(V.a)({},e),{},{type:"rejectPayment"})),n(Te("Rejecting payment\u2026")),n({type:"clearActions"}),De(a()).rejectPayment(e.payload.payment,e.payload.challenges[0])}catch(r){n(Ce(r))}case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()})),Object(y.a)(vt,C,(function(e){return function(){var t=Object(ne.a)(te.a.mark((function t(n,a){var r,c;return te.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{n(Object(V.a)(Object(V.a)({},e),{},{type:"rejectSignature"})),n(Te("Rejecting signature\u2026")),n({type:"clearActions"}),n({type:"clearSignature"}),r=De(a()),(c=new W.a.remotepay.VerifySignatureRequest).setPayment(e.payload.payment),r.rejectSignature(c)}catch(o){n(Ce(o))}case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()})),Object(y.a)(vt,N,$e),Object(y.a)(vt,k,et),Object(y.a)(vt,D,dt),Object(y.a)(vt,T,(function(e){var t=e.payload;return{type:"setTransactionMode",payload:t.mode}})),vt),Jt={TRANSACTION:"TRANSACTION",HISTORY:"HISTORY"},Gt=Object(be.a)(De,(function(e){return!!e})),Xt=n(663),Zt=function(e){var t=e.width,n=void 0===t?250:t,a=Object(ae.a)(e,["width"]),r=Object(d.c)(Tt),c=Object(d.c)(It);return c.length?l.a.createElement("div",{className:"Signature"},l.a.createElement("svg",Object.assign({viewBox:r,width:n},a),c.map((function(e,t){return l.a.createElement("polyline",{key:t,points:e,fill:"none",stroke:"black"})})))):null},$t=function(){var e=Object(Lt.a)().t,t=Object(d.c)(At),n=Object(d.c)(nt),a=Object(d.c)(ot),r=Object(d.c)(it),c=Object(i.useMemo)((function(){var n=t.match(/^Partial authorization for (.+)\nContinue with transaction\?$/);if(n){var a=Object(me.a)(n,2)[1];return l.a.createElement(Xt.a,{i18nKey:"STATUS~Partial authorization",amount:a},"Partial authorization for ",{amount:a},"Continue with transaction?")}var r=t.match(/^Processing Card ending in (\d+)\u2026$/);if(r){var c=Object(me.a)(r,2)[1];return l.a.createElement(Xt.a,{i18nKey:"STATUS~Processing card ending",last4:c},"Processing Card ending in ",{last4:c},"\u2026")}return e(["STATUS~".concat(t),t])}),[t,e]);return l.a.createElement("div",{className:"Screen alert alert-secondary"},!!r&&l.a.createElement("div",{className:"Transaction d-flex justify-content-between bg-white rounded-top border-bottom border-secondary"},l.a.createElement("div",{className:"font-italic"},e(["TRANSACTION~".concat(a),a])),l.a.createElement("div",{className:"font-weight-bold"},fe(r))),!n&&l.a.createElement("div",null,c),l.a.createElement(Zt,null),n&&l.a.createElement("div",{className:"text-muted"},n),n&&l.a.createElement("h3",{className:"text-right"},fe(n)))},Qt=n(306),en=n(671),tn=n(672),nn=n(664),an=n(665),rn=Object(i.forwardRef)((function(e,t){var n=e.action,a=e.height,r=e.color,c=e.keyCodes,o=e.disabled,s=e.onClick,u=e.moreActions,d=e.moreText,m=e.onMoreClick,p=e.children,f=Object(ae.a)(e,["action","height","color","keyCodes","disabled","onClick","moreActions","moreText","onMoreClick","children"]),v=Object(Lt.a)().t,y=Object(i.useState)(!1),b=Object(me.a)(y,2),O=b[0],h=b[1],E=Object(i.useCallback)((function(){return h((function(e){return!e}))}),[h]);Object(i.useEffect)((function(){if(!o){var e=function(e){return!c.includes(e.code)||(e.preventDefault(),s(),!1)};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}}),[o,c,s]);var j=Object(i.useMemo)((function(){var e,t=(null===n||void 0===n||null===(e=n.payload)||void 0===e?void 0:e.description)||(null===n||void 0===n?void 0:n.type);return t?v(["ACTION~".concat(t),t]):p}),[n,p,v]),g=Object(i.useMemo)((function(){return[v("Shortcut keys"),c.map((function(e){return v(["KEY_CODE~".concat(e),e])})).join(", ")].join(": ")}),[c,v]);return n&&(null===u||void 0===u?void 0:u.length)?l.a.createElement(en.a,{isOpen:O,toggle:E},l.a.createElement(_t.a,Object.assign({color:"dark",className:"action rounded-left",onClick:s,disabled:o,title:g},f),j||l.a.createElement("span",null,"\xa0")),l.a.createElement(tn.a,{caret:!0,color:"dark",className:"action",disabled:o}),l.a.createElement(nn.a,{className:"bg-dark",right:!0},u.map((function(e,t){var n,a;return l.a.createElement(an.a,{key:t,className:"bg-dark text-light",onClick:function(){return m(e)}},v(["ACTION~".concat((null===(n=e.payload)||void 0===n?void 0:n.description)||e.type),(null===(a=e.payload)||void 0===a?void 0:a.description)||e.type]))})))):(null===u||void 0===u?void 0:u.length)?l.a.createElement("div",{className:"btn-group-vertical d-flex flex-column"},l.a.createElement(en.a,{isOpen:O,toggle:E},l.a.createElement(tn.a,{caret:!0,color:"dark",outline:!0,size:"sm",className:"text-light"},d),l.a.createElement(nn.a,{right:!0,className:"bg-dark"},u.map((function(e,t){var n,a;return l.a.createElement(an.a,{key:t,className:"bg-dark text-light",onClick:function(){return m(e)}},v(["ACTION~".concat((null===(n=e.payload)||void 0===n?void 0:n.description)||e.type),(null===(a=e.payload)||void 0===a?void 0:a.description)||e.type]))})))),l.a.createElement(_t.a,Object.assign({outline:!0,color:"dark",className:Rt()("h-100","text-".concat(r||"light")),onClick:s,disabled:o,title:g},f),j||l.a.createElement("span",null,"\xa0"))):l.a.createElement(_t.a,Object.assign({innerRef:t,style:{height:a},outline:!n,color:"dark",className:Rt()("text-".concat(r||"light"),{action:n}),disabled:o,onClick:s,title:g},f),j)})),cn=function(){var e=Object(Lt.a)().t,t=Object(d.b)(),n=Object(d.c)(ht),a=Object(d.c)(Ot),r=Object(d.c)(ut),c=Object(d.c)(Nt),o=Object(i.useState)(!1),s=Object(me.a)(o,2),u=s[0],m=s[1],p=Object(i.useMemo)((function(){return!a||u}),[a,u]),f=Object(i.useCallback)(function(){var e=Object(ne.a)(te.a.mark((function e(n){return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),n.type!==j&&n.type!==T||setTimeout((function(){return m(!1)}),250),e.next=4,t(Ht[n.type](n));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[t,m]),v=function(e){return Object(ne.a)(te.a.mark((function t(){return te.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",f(e));case 1:case"end":return t.stop()}}),t)})))};Object(i.useEffect)((function(){n.length&&m(!1)}),[m,n]);var y=Object(i.useRef)(),b=Object(i.useState)(),O=Object(me.a)(b,2),h=O[0],E=O[1];Object(i.useEffect)((function(){y.current&&E(y.current.offsetWidth)}),[y,E]);var g=Object(i.useMemo)((function(){return c?{moreText:e(["TRANSACTION~".concat(r),r]),moreActions:[{type:T,payload:{description:"TRANSACTION~SALE",mode:P}},{type:T,payload:{description:"TRANSACTION~CREDIT",mode:M}}],onMoreClick:function(e){return f(e)}}:void 0}),[c,f,e,r]),C=Object(Qt.a)(n),N=C[0],k=C[1],D=C.slice(2);return l.a.createElement("div",{className:"Keys"},l.a.createElement("div",{className:"row no-gutters"},l.a.createElement("div",{className:"col-6 p-1"},l.a.createElement(rn,{action:N||{},disabled:!N||u,keyCodes:["F1","NumpadDivide"],onClick:v(N)})),l.a.createElement("div",{className:"col-6 p-1"},l.a.createElement(rn,{action:k||{},disabled:!k||u,keyCodes:["F2","NumpadMultiply"],onClick:v(k),moreActions:D,onMoreClick:function(e){return f(e)}}))),l.a.createElement("div",{className:"row no-gutters"},l.a.createElement("div",{className:"col-3 p-1"},l.a.createElement(rn,{ref:y,height:h,disabled:p,keyCodes:["Numpad7","Digit7"],onClick:function(){return t(tt("7"))}},e("KEY~7"))),l.a.createElement("div",{className:"col-3 p-1"},l.a.createElement(rn,{disabled:p,keyCodes:["Numpad8","Digit8"],onClick:function(){return t(tt("8"))}},e("KEY~8"))),l.a.createElement("div",{className:"col-3 p-1"},l.a.createElement(rn,{disabled:p,keyCodes:["Numpad9","Digit9"],onClick:function(){return t(tt("9"))}},e("KEY~9"))),l.a.createElement("div",{className:"col-3 p-1"},l.a.createElement(rn,{color:"danger",disabled:p,keyCodes:["NumpadSubtract","Escape"],onClick:function(){return t({type:"clearBuffer"})}},e("KEY~X")))),l.a.createElement("div",{className:"row no-gutters"},l.a.createElement("div",{className:"col-3 p-1"},l.a.createElement(rn,{height:h,disabled:p,keyCodes:["Numpad4","Digit4"],onClick:function(){return t(tt("4"))}},e("KEY~4"))),l.a.createElement("div",{className:"col-3 p-1"},l.a.createElement(rn,{disabled:p,keyCodes:["Numpad5","Digit5"],onClick:function(){return t(tt("5"))}},e("KEY~5"))),l.a.createElement("div",{className:"col-3 p-1"},l.a.createElement(rn,{disabled:p,keyCodes:["Numpad6","Digit6"],onClick:function(){return t(tt("6"))}},e("KEY~6"))),l.a.createElement("div",{className:"col-3 p-1"},l.a.createElement(rn,{color:"warning",disabled:p,keyCodes:["NumpadAdd","Backspace","Delete"],onClick:function(){return t({type:"undoBuffer"})}},e("KEY~<")))),l.a.createElement("div",{className:"row no-gutters"},l.a.createElement("div",{className:"col-9"},l.a.createElement("div",{className:"row no-gutters"},l.a.createElement("div",{className:"col-4 p-1"},l.a.createElement(rn,{height:h,disabled:p,keyCodes:["Numpad1","Digit1"],onClick:function(){return t(tt("1"))}},e("KEY~1"))),l.a.createElement("div",{className:"col-4 p-1"},l.a.createElement(rn,{disabled:p,keyCodes:["Numpad2","Digit2"],onClick:function(){return t(tt("2"))}},e("KEY~2"))),l.a.createElement("div",{className:"col-4 p-1"},l.a.createElement(rn,{disabled:p,keyCodes:["Numpad3","Digit3"],onClick:function(){return t(tt("3"))}},e("KEY~3")))),l.a.createElement("div",{className:"row no-gutters"},l.a.createElement("div",{className:"col-8 p-1"},l.a.createElement(rn,{height:h,disabled:p,keyCodes:["Numpad0","Digit0"],onClick:function(){return t(tt("0"))}},e("KEY~0"))),l.a.createElement("div",{className:"col-4 p-1"},l.a.createElement(rn,{disabled:p,keyCodes:["NumpadDecimal","Period"],onClick:function(){return t(tt("00"))}},e("KEY~00"))))),l.a.createElement("div",{className:"col-3 p-1"},l.a.createElement(rn,Object.assign({color:"success",disabled:p,keyCodes:["NumpadEnter","Enter"],onClick:function(){return t(dt())}},g),e("KEY~O")))))},on=function(e){var t=e.mode,n=e.setMode,a=Object(Lt.a)().t,r=Object(d.b)(),c=Object(i.useState)(!1),o=Object(me.a)(c,2),s=o[0],u=o[1],m=Object(i.useCallback)((function(){return u(!s)}),[s,u]),p=Object(i.useCallback)((function(){return r(et())}),[r]),f=Object(i.useCallback)((function(){return r($e())}),[r]),v=Object(i.useCallback)((function(){return r(We())}),[r]);return l.a.createElement(en.a,{isOpen:s,toggle:m},l.a.createElement(tn.a,{size:"sm",outline:!0,color:"dark",className:"text-light",onClick:m,title:a("Menu")},"\u2630"),l.a.createElement(nn.a,{right:!0},Object.values(Jt).map((function(e){return l.a.createElement(an.a,{key:e,onClick:function(){return n(e)}},l.a.createElement(Ut,{id:"mode-".concat(e),label:a(["MODE~".concat(e),e]),checked:e===t,readOnly:!0,mb0:!0}))})),l.a.createElement(an.a,{divider:!0}),l.a.createElement(an.a,{onClick:p},a("Show Welcome")),l.a.createElement(an.a,{onClick:f},a("Reset Device")),l.a.createElement(an.a,{onClick:v},a("Disconnect"))))},ln=n(666),sn=n(668),un=n(667),dn=n(670),mn=function(e){var t=e.amount,n=e.tipAmount,a=e.payment,r=(t||0)+(n||0),c=((null===a||void 0===a?void 0:a.amount)||0)+((null===a||void 0===a?void 0:a.tipAmount)||0);return{start:r,final:c,partial:r>c,remaining:r-c}},pn=function(e){var t,n,a=e.transaction,r=a||{},c=r.id,o=r.timestamp,s=r.type,u=r.payment,p=Object(Lt.a)().t,f=Object(d.b)(),v=Object(m.useToasts)().removeToast,y=Object(d.c)(kt),b=Date.now(),O=Object(dn.a)(o,{minutes:26}),h=Object(i.useState)(y&&b<=O),E=Object(me.a)(h,2),j=E[0],g=E[1];Object(i.useEffect)((function(){if(j){var e=O-b;if(e>0){var t=setTimeout((function(){return g(!1)}),e);return function(){return clearTimeout(t)}}}}),[b,g,j,O]);var C=mn(a),N=C.partial,k=C.remaining,D=Object(i.useCallback)(Object(ne.a)(te.a.mark((function e(){return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f({type:"setBuffer",payload:k||""});case 3:return e.next=5,f(dt());case 5:e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(0),e.next=11,f(Ce(e.t0));case 11:case"end":return e.stop()}}),e,null,[[0,7]])}))),[k,f]),T=Object(i.useCallback)(Object(ne.a)(te.a.mark((function e(){return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,v(c),e.next=4,f(qe(c));case 4:return e.next=6,f(mt(u));case 6:e.next=12;break;case 8:return e.prev=8,e.t0=e.catch(0),e.next=12,f(Ce(e.t0));case 12:case"end":return e.stop()}}),e,null,[[0,8]])}))),[f,c,u,v]);return l.a.createElement("div",{className:"Transaction"},a.type!==_&&N&&l.a.createElement("div",{className:"alert alert-warning"},l.a.createElement("h6",{className:"alert-heading"},p("Partial Payment")),l.a.createElement("div",null,p("Remaining"),": ",fe(k))),l.a.createElement("h5",null,p(["TRANSACTION~".concat(s),s])," ",p("Details")),l.a.createElement(ln.a,{size:"sm",className:"small mb-0"},l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement("th",null,p("Payment ID"),":"),l.a.createElement("td",null,u.id)),u.externalPaymentId&&l.a.createElement("tr",null,l.a.createElement("th",null,p("External ID"),":"),l.a.createElement("td",null,u.externalPaymentId)),u.externalReferenceId&&l.a.createElement("tr",null,l.a.createElement("th",null,p("External Ref"),":"),l.a.createElement("td",null,u.externalReferenceId)),l.a.createElement("tr",null,l.a.createElement("th",null,p("Order ID"),":"),l.a.createElement("td",null,(null===(t=u.order)||void 0===t?void 0:t.id)||(null===(n=u.orderRef)||void 0===n?void 0:n.id))),!!u.tipAmount&&l.a.createElement("tr",null,l.a.createElement("th",null,p("Total"),":"),l.a.createElement("td",null,fe(u.amount+u.tipAmount))),l.a.createElement("tr",null,l.a.createElement("th",null,p("Amount"),":"),l.a.createElement("td",null,fe(u.amount))),!!u.tipAmount&&l.a.createElement("tr",null,l.a.createElement("th",null,p("Tip"),":"),l.a.createElement("td",null,fe(u.tipAmount))),l.a.createElement("tr",null,l.a.createElement("th",null,p("Card"),":"),l.a.createElement("td",null,l.a.createElement("div",null,p(["CARD~".concat(u.cardTransaction.cardType),u.cardTransaction.cardType])),l.a.createElement("div",null,function(e){var t=e.first6,n=e.last4;return[t,"*".repeat(6),n].join("").replace(/.{4}/g," $&").trim()}(u.cardTransaction)),u.cardTransaction.cardholderName&&l.a.createElement("div",null,p(["CARDHOLDER_NAME~".concat(u.cardTransaction.cardholderName),u.cardTransaction.cardholderName])))))),a.type===P&&l.a.createElement("div",null,N&&l.a.createElement(_t.a,{color:"primary",size:"sm",className:"mr-1",onClick:D},p("Process")," ",fe(k)),j&&l.a.createElement(_t.a,{color:"danger",size:"sm",onClick:T},p("Void"))))},fn=function(){var e=Object(d.b)(),t=Object(m.useToasts)().addToast;return function(n){var a,r=mn(n);a=n.type===_?"info":r.final>=r.start?"success":r.final<r.start?"warning":"info",t(l.a.createElement(pn,{transaction:n}),{id:n.id,appearance:a,autoDismiss:!1,onDismiss:function(){e(qe(n.id))}})}},vn=function(){var e=Object(Lt.a)().t,t=Object(d.c)(lt),n=fn(),a=Object(i.useMemo)((function(){return t.sort((function(e,t){return Object(un.a)(e.timestamp,t.timestamp)}))}),[t]);return l.a.createElement("div",{className:"History"},l.a.createElement(ln.a,{size:"sm",hover:!0,className:"table-secondary",striped:!0},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,e("Date")),l.a.createElement("th",null,e("Type")),l.a.createElement("th",{className:"text-right"},e("Amount")))),l.a.createElement("tbody",null,a.map((function(e){return l.a.createElement("tr",{key:e.id,role:"button",onClick:function(){return n(e)}},l.a.createElement("td",null,function(e){var t=e.timestamp;return t?Object(sn.a)(t,"M/d h:mm a"):"??"}(e)),l.a.createElement("td",null,e.type),l.a.createElement("td",{className:"text-right"},function(e){var t=e.amount,n=e.tipAmount,a=e.payment;return fe(a?(a.amount||0)+(a.tipAmount||0):(t||0)+(n||0))}(e)))})))))},yn=(n(654),function(){var e=Object(Lt.a)().t,t=Object(d.c)(Gt),n=Object(i.useState)(Jt.TRANSACTION),a=Object(me.a)(n,2),r=a[0],c=a[1];return t?l.a.createElement(xt.a,{className:"Keypad"},l.a.createElement(St.a,null,l.a.createElement(Kt,null),l.a.createElement("h3",null,e("Virtual Keypad")),l.a.createElement(on,{mode:r,setMode:c})),l.a.createElement(Pt.a,null,r===Jt.TRANSACTION&&l.a.createElement($t,null),r===Jt.TRANSACTION&&l.a.createElement(cn,null),r===Jt.HISTORY&&l.a.createElement(vn,null))):null}),bn=function(e){var t=e.error,n=t.message,a=t.stack,r=Object(Lt.a)().t,c=Object(i.useState)(!1),o=Object(me.a)(c,2),s=o[0],u=o[1];return Object(i.useEffect)((function(){return function(){document.querySelectorAll(".Error.expanded").length-(s?1:0)||document.querySelector(".react-toast-notifications__container").classList.remove("expanded")}}),[s]),l.a.createElement("div",{className:Rt()("Error",{expanded:s})},l.a.createElement("h5",null,r(["ERROR~".concat(n),n])),!!a&&!s&&l.a.createElement(_t.a,{color:"link",size:"small",onClick:function(){document.querySelector(".react-toast-notifications__container").classList.add("expanded"),u(!0)}},r("Show details")),!!a&&s&&l.a.createElement("pre",{className:"mb-0"},l.a.createElement("code",null,a)))},On=(n(655),function(){return function(e){var t=Object(d.b)(),n=Object(d.c)(Qe),a=Object(m.useToasts)().addToast;Object(i.useEffect)((function(){n.message&&a(l.a.createElement(bn,{error:n}),{id:"error",appearance:"error",autoDismiss:e,onDismiss:function(){t({type:"clearError"})}})}),[a,t,n,e])}(function(){var e=Object(i.useState)(!1),t=Object(me.a)(e,2),n=t[0],a=t[1];return Object(i.useEffect)((function(){if(!n){var e=function(){return a(!0)};return document.addEventListener("mouseover",e),function(){return document.removeEventListener("mouseover",e)}}}),[n,a]),n}()),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.ms,n=void 0===t?500:t;Object(i.useEffect)((function(){var e=0,t=function(t){if(1===t.touches.length){var a=Date.now();1===t.touches.length&&a>e&&(t.preventDefault(),t.target.click()),e=a+n}};return document.body.addEventListener("touchstart",t,{passive:!1}),function(){return document.body.removeEventListener("touchstart",t,{passive:!1})}}),[n])}(),function(){var e=Object(d.c)(st),t=fn();Object(i.useEffect)((function(){e.forEach(t)}),[e,t])}(),l.a.createElement("div",{className:Rt()("App container maxwidth")},l.a.createElement(Ft,null),l.a.createElement(Wt,null),l.a.createElement(yn,null))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(d.a,{store:yt},l.a.createElement(m.ToastProvider,{placement:"bottom-center"},l.a.createElement(On,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[312,1,2]]]);
//# sourceMappingURL=main.18a4c303.chunk.js.map